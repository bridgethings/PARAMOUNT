import{C as ae,w as S,D as as,e as Ee,E as os,F as ls,j as e,O as rs,R as is,B as V,H as be,J as ds,K as oe,L as Q,M as cs,N as ke,P as us,Q as Pe,V as hs,r as X,f as O,u as P,U as ms,W as xs,h as fs,a as ue,X as Re,d as he,g as Oe,Y as ps,Z as gs,_ as js,n as vs,c as ys,$ as bs,k as ye,s as le,S as q,G as v,v as Y,a0 as Cs,a1 as _s,T as b,a2 as Ss,x as B,a3 as ce,y as L,a4 as Ts,A as $,a5 as ws,t as Be,a6 as Is}from"./index-Dtok5lqr.js";import{a as Ns,T as ne,C as ze}from"./ConfigCard-DDrp2vfQ.js";import{B as Ms,D as As,P as Rs,S as Bs,V as U,F as zs,a as Ds,E as Es}from"./configOptions-D2Lb2xen.js";import{N as K,B as De,I as ks,C as k,D as Ce}from"./IconRefresh-DwiZIkO0.js";import{T as Ps,I as Os}from"./IconUpload-DONrzCPZ.js";import{u as $s,I as Fs}from"./useConfiguration-DNi-2m-g.js";const[Ls,G]=ae("ModalBase component was not found in tree");function Vs({opened:s,transitionDuration:t}){const[n,a]=S.useState(s),r=S.useRef(-1),c=as()?0:t;return S.useEffect(()=>(s?(a(!0),window.clearTimeout(r.current)):c===0?a(!1):r.current=window.setTimeout(()=>a(!1),c),()=>window.clearTimeout(r.current)),[s,c]),n}function Hs({id:s,transitionProps:t,opened:n,trapFocus:a,closeOnEscape:r,onClose:i,returnFocus:c}){const o=Ee(s),[h,u]=S.useState(!1),[m,C]=S.useState(!1),g=typeof(t==null?void 0:t.duration)=="number"?t==null?void 0:t.duration:200,l=Vs({opened:n,transitionDuration:g});return os("keydown",j=>{var _;j.key==="Escape"&&r&&n&&((_=j.target)==null?void 0:_.getAttribute("data-mantine-stop-propagation"))!=="true"&&i()},{capture:!0}),ls({opened:n,shouldReturnFocus:a&&c}),{_id:o,titleMounted:h,bodyMounted:m,shouldLockScroll:l,setTitleMounted:u,setBodyMounted:C}}const $e=S.forwardRef(({keepMounted:s,opened:t,onClose:n,id:a,transitionProps:r,onExitTransitionEnd:i,onEnterTransitionEnd:c,trapFocus:o,closeOnEscape:h,returnFocus:u,closeOnClickOutside:m,withinPortal:C,portalProps:g,lockScroll:l,children:j,zIndex:_,shadow:p,padding:f,__vars:w,unstyled:A,removeScrollProps:y,...T},R)=>{const{_id:N,titleMounted:I,bodyMounted:M,shouldLockScroll:F,setTitleMounted:Z,setBodyMounted:d}=Hs({id:a,transitionProps:r,opened:t,trapFocus:o,closeOnEscape:h,onClose:n,returnFocus:u}),{key:D,...E}=y||{};return e.jsx(rs,{...g,withinPortal:C,children:e.jsx(Ls,{value:{opened:t,onClose:n,closeOnClickOutside:m,onExitTransitionEnd:i,onEnterTransitionEnd:c,transitionProps:{...r,keepMounted:s},getTitleId:()=>`${N}-title`,getBodyId:()=>`${N}-body`,titleMounted:I,bodyMounted:M,setTitleMounted:Z,setBodyMounted:d,trapFocus:o,closeOnEscape:h,zIndex:_,unstyled:A},children:e.jsx(is,{enabled:F&&l,...E,children:e.jsx(V,{ref:R,...T,__vars:{...w,"--mb-z-index":(_||oe("modal")).toString(),"--mb-shadow":ds(p),"--mb-padding":be(f)},children:j})},D)})})});$e.displayName="@mantine/core/ModalBase";function Us(){const s=G();return S.useEffect(()=>(s.setBodyMounted(!0),()=>s.setBodyMounted(!1)),[]),s.getBodyId()}var ee={title:"m_615af6c9",header:"m_b5489c3c",inner:"m_60c222c7",content:"m_fd1ab0aa",close:"m_606cb269",body:"m_5df29311"};const Fe=S.forwardRef(({className:s,...t},n)=>{const a=Us(),r=G();return e.jsx(V,{ref:n,...t,id:a,className:Q({[ee.body]:!r.unstyled},s)})});Fe.displayName="@mantine/core/ModalBaseBody";const Le=S.forwardRef(({className:s,onClick:t,...n},a)=>{const r=G();return e.jsx(cs,{ref:a,...n,onClick:i=>{r.onClose(),t==null||t(i)},className:Q({[ee.close]:!r.unstyled},s),unstyled:r.unstyled})});Le.displayName="@mantine/core/ModalBaseCloseButton";const Ve=S.forwardRef(({transitionProps:s,className:t,innerProps:n,onKeyDown:a,style:r,...i},c)=>{const o=G();return e.jsx(ke,{mounted:o.opened,transition:"pop",...o.transitionProps,onExited:()=>{var h,u,m;(h=o.onExitTransitionEnd)==null||h.call(o),(m=(u=o.transitionProps)==null?void 0:u.onExited)==null||m.call(u)},onEntered:()=>{var h,u,m;(h=o.onEnterTransitionEnd)==null||h.call(o),(m=(u=o.transitionProps)==null?void 0:u.onEntered)==null||m.call(u)},...s,children:h=>e.jsx("div",{...n,className:Q({[ee.inner]:!o.unstyled},n.className),children:e.jsx(us,{active:o.opened&&o.trapFocus,innerRef:c,children:e.jsx(Pe,{...i,component:"section",role:"dialog",tabIndex:-1,"aria-modal":!0,"aria-describedby":o.bodyMounted?o.getBodyId():void 0,"aria-labelledby":o.titleMounted?o.getTitleId():void 0,style:[r,h],className:Q({[ee.content]:!o.unstyled},t),unstyled:o.unstyled,children:i.children})})})})});Ve.displayName="@mantine/core/ModalBaseContent";const He=S.forwardRef(({className:s,...t},n)=>{const a=G();return e.jsx(V,{component:"header",ref:n,className:Q({[ee.header]:!a.unstyled},s),...t})});He.displayName="@mantine/core/ModalBaseHeader";const qs={duration:200,timingFunction:"ease",transition:"fade"};function Gs(s){const t=G();return{...qs,...t.transitionProps,...s}}const Ue=S.forwardRef(({onClick:s,transitionProps:t,style:n,visible:a,...r},i)=>{const c=G(),o=Gs(t);return e.jsx(ke,{mounted:a!==void 0?a:c.opened,...o,transition:"fade",children:h=>e.jsx(hs,{ref:i,fixed:!0,style:[n,h],zIndex:c.zIndex,unstyled:c.unstyled,onClick:u=>{s==null||s(u),c.closeOnClickOutside&&c.onClose()},...r})})});Ue.displayName="@mantine/core/ModalBaseOverlay";function Ws(){const s=G();return S.useEffect(()=>(s.setTitleMounted(!0),()=>s.setTitleMounted(!1)),[]),s.getTitleId()}const qe=S.forwardRef(({className:s,...t},n)=>{const a=Ws(),r=G();return e.jsx(V,{component:"h2",ref:n,className:Q({[ee.title]:!r.unstyled},s),...t,id:a})});qe.displayName="@mantine/core/ModalBaseTitle";function Zs({children:s}){return e.jsx(e.Fragment,{children:s})}const[Xs,Se]=ae("Accordion component was not found in the tree");function Te({style:s,size:t=16,...n}){return e.jsx("svg",{viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{...s,width:X(t),height:X(t),display:"block"},...n,children:e.jsx("path",{d:"M3.13523 6.15803C3.3241 5.95657 3.64052 5.94637 3.84197 6.13523L7.5 9.56464L11.158 6.13523C11.3595 5.94637 11.6759 5.95657 11.8648 6.15803C12.0536 6.35949 12.0434 6.67591 11.842 6.86477L7.84197 10.6148C7.64964 10.7951 7.35036 10.7951 7.15803 10.6148L3.15803 6.86477C2.95657 6.67591 2.94637 6.35949 3.13523 6.15803Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"})})}Te.displayName="@mantine/core/AccordionChevron";const[Ks,Ge]=ae("Accordion.Item component was not found in the tree");var re={root:"m_9bdbb667",panel:"m_df78851f",content:"m_4ba554d4",itemTitle:"m_8fa820a0",control:"m_4ba585b8","control--default":"m_6939a5e9","control--contained":"m_4271d21b",label:"m_df3ffa0f",chevron:"m_3f35ae96",icon:"m_9bd771fe",item:"m_9bd7b098","item--default":"m_fe19b709","item--contained":"m_1f921b3b","item--filled":"m_2cdf939a","item--separated":"m_9f59b069"};const Ys={},we=O((s,t)=>{const{classNames:n,className:a,style:r,styles:i,vars:c,chevron:o,icon:h,onClick:u,onKeyDown:m,children:C,disabled:g,mod:l,...j}=P("AccordionControl",Ys,s),{value:_}=Ge(),p=Se(),f=p.isItemActive(_),w=typeof p.order=="number",A=`h${p.order}`,y=e.jsxs(ms,{...j,...p.getStyles("control",{className:a,classNames:n,style:r,styles:i,variant:p.variant}),unstyled:p.unstyled,mod:["accordion-control",{active:f,"chevron-position":p.chevronPosition,disabled:g},l],ref:t,onClick:T=>{u==null||u(T),p.onChange(_)},type:"button",disabled:g,"aria-expanded":f,"aria-controls":p.getRegionId(_),id:p.getControlId(_),onKeyDown:xs({siblingSelector:"[data-accordion-control]",parentSelector:"[data-accordion]",activateOnFocus:!1,loop:p.loop,orientation:"vertical",onKeyDown:m}),children:[e.jsx(V,{component:"span",mod:{rotate:!p.disableChevronRotation&&f,position:p.chevronPosition},...p.getStyles("chevron",{classNames:n,styles:i}),children:o||p.chevron}),e.jsx("span",{...p.getStyles("label",{classNames:n,styles:i}),children:C}),h&&e.jsx(V,{component:"span",mod:{"chevron-position":p.chevronPosition},...p.getStyles("icon",{classNames:n,styles:i}),children:h})]});return w?e.jsx(A,{...p.getStyles("itemTitle",{classNames:n,styles:i}),children:y}):y});we.displayName="@mantine/core/AccordionControl";we.classes=re;const Js={},Ie=O((s,t)=>{const{classNames:n,className:a,style:r,styles:i,vars:c,value:o,mod:h,...u}=P("AccordionItem",Js,s),m=Se();return e.jsx(Ks,{value:{value:o},children:e.jsx(V,{ref:t,mod:[{active:m.isItemActive(o)},h],...m.getStyles("item",{className:a,classNames:n,styles:i,style:r,variant:m.variant}),...u})})});Ie.displayName="@mantine/core/AccordionItem";Ie.classes=re;const Qs={},Ne=O((s,t)=>{const{classNames:n,className:a,style:r,styles:i,vars:c,children:o,...h}=P("AccordionPanel",Qs,s),{value:u}=Ge(),m=Se();return e.jsx(Ns,{ref:t,...m.getStyles("panel",{className:a,classNames:n,style:r,styles:i}),...h,in:m.isItemActive(u),transitionDuration:m.transitionDuration??200,role:"region",id:m.getRegionId(u),"aria-labelledby":m.getControlId(u),children:e.jsx("div",{...m.getStyles("content",{classNames:n,styles:i}),children:o})})});Ne.displayName="@mantine/core/AccordionPanel";Ne.classes=re;const et={multiple:!1,disableChevronRotation:!1,chevronPosition:"right",variant:"default",chevron:e.jsx(Te,{})},st=he((s,{transitionDuration:t,chevronSize:n,radius:a})=>({root:{"--accordion-transition-duration":t===void 0?void 0:`${t}ms`,"--accordion-chevron-size":n===void 0?void 0:X(n),"--accordion-radius":a===void 0?void 0:Oe(a)}}));function z(s){const t=P("Accordion",et,s),{classNames:n,className:a,style:r,styles:i,unstyled:c,vars:o,children:h,multiple:u,value:m,defaultValue:C,onChange:g,id:l,loop:j,transitionDuration:_,disableChevronRotation:p,chevronPosition:f,chevronSize:w,order:A,chevron:y,variant:T,radius:R,...N}=t,I=Ee(l),[M,F]=fs({value:m,defaultValue:C,finalValue:u?[]:null,onChange:g}),Z=E=>Array.isArray(M)?M.includes(E):E===M,d=E=>{const te=Array.isArray(M)?M.includes(E)?M.filter(ns=>ns!==E):[...M,E]:E===M?null:E;F(te)},D=ue({name:"Accordion",classes:re,props:t,className:a,style:r,classNames:n,styles:i,unstyled:c,vars:o,varsResolver:st});return e.jsx(Xs,{value:{isItemActive:Z,onChange:d,getControlId:Re(`${I}-control`,"Accordion.Item component was rendered with invalid value or without value"),getRegionId:Re(`${I}-panel`,"Accordion.Item component was rendered with invalid value or without value"),transitionDuration:_,disableChevronRotation:p,chevronPosition:f,order:A,chevron:y,loop:j,getStyles:D,variant:T,unstyled:c},children:e.jsx(V,{...D("root"),id:I,...N,variant:T,"data-accordion":!0,children:h})})}const tt=s=>s;z.extend=tt;z.withProps=ps(z);z.classes=re;z.displayName="@mantine/core/Accordion";z.Item=Ie;z.Panel=Ne;z.Control=we;z.Chevron=Te;const nt={multiple:!1},We=S.forwardRef((s,t)=>{const{onChange:n,children:a,multiple:r,accept:i,name:c,form:o,resetRef:h,disabled:u,capture:m,inputProps:C,...g}=P("FileButton",nt,s),l=S.useRef(null),j=()=>{var f;!u&&((f=l.current)==null||f.click())},_=f=>{n(r?Array.from(f.currentTarget.files):f.currentTarget.files[0]||null)};return gs(h,()=>{l.current&&(l.current.value="")}),e.jsxs(e.Fragment,{children:[a({onClick:j,...g}),e.jsx("input",{style:{display:"none"},type:"file",accept:i,multiple:r,onChange:_,ref:js(t,l),name:c,form:o,capture:m,...C})]})});We.displayName="@mantine/core/FileButton";const[at,se]=ae("Modal component was not found in tree");var W={root:"m_9df02822",content:"m_54c44539",inner:"m_1f958f16",header:"m_d0e2b9cd"};const ot={},me=O((s,t)=>{const n=P("ModalBody",ot,s),{classNames:a,className:r,style:i,styles:c,vars:o,...h}=n,u=se();return e.jsx(Fe,{ref:t,...u.getStyles("body",{classNames:a,style:i,styles:c,className:r}),...h})});me.classes=W;me.displayName="@mantine/core/ModalBody";const lt={},xe=O((s,t)=>{const n=P("ModalCloseButton",lt,s),{classNames:a,className:r,style:i,styles:c,vars:o,...h}=n,u=se();return e.jsx(Le,{ref:t,...u.getStyles("close",{classNames:a,style:i,styles:c,className:r}),...h})});xe.classes=W;xe.displayName="@mantine/core/ModalCloseButton";const rt={},fe=O((s,t)=>{const n=P("ModalContent",rt,s),{classNames:a,className:r,style:i,styles:c,vars:o,children:h,__hidden:u,...m}=n,C=se(),g=C.scrollAreaComponent||Zs;return e.jsx(Ve,{...C.getStyles("content",{className:r,style:i,styles:c,classNames:a}),innerProps:C.getStyles("inner",{className:r,style:i,styles:c,classNames:a}),"data-full-screen":C.fullScreen||void 0,"data-modal-content":!0,"data-hidden":u||void 0,ref:t,...m,children:e.jsx(g,{style:{maxHeight:C.fullScreen?"100dvh":`calc(100dvh - (${X(C.yOffset)} * 2))`},children:h})})});fe.classes=W;fe.displayName="@mantine/core/ModalContent";const it={},pe=O((s,t)=>{const n=P("ModalHeader",it,s),{classNames:a,className:r,style:i,styles:c,vars:o,...h}=n,u=se();return e.jsx(He,{ref:t,...u.getStyles("header",{classNames:a,style:i,styles:c,className:r}),...h})});pe.classes=W;pe.displayName="@mantine/core/ModalHeader";const dt={},ge=O((s,t)=>{const n=P("ModalOverlay",dt,s),{classNames:a,className:r,style:i,styles:c,vars:o,...h}=n,u=se();return e.jsx(Ue,{ref:t,...u.getStyles("overlay",{classNames:a,style:i,styles:c,className:r}),...h})});ge.classes=W;ge.displayName="@mantine/core/ModalOverlay";const ct={__staticSelector:"Modal",closeOnClickOutside:!0,withinPortal:!0,lockScroll:!0,trapFocus:!0,returnFocus:!0,closeOnEscape:!0,keepMounted:!1,zIndex:oe("modal"),transitionProps:{duration:200,transition:"fade-down"},yOffset:"5dvh"},ut=he((s,{radius:t,size:n,yOffset:a,xOffset:r})=>({root:{"--modal-radius":t===void 0?void 0:Oe(t),"--modal-size":vs(n,"modal-size"),"--modal-y-offset":X(a),"--modal-x-offset":X(r)}})),je=O((s,t)=>{const n=P("ModalRoot",ct,s),{classNames:a,className:r,style:i,styles:c,unstyled:o,vars:h,yOffset:u,scrollAreaComponent:m,radius:C,fullScreen:g,centered:l,xOffset:j,__staticSelector:_,...p}=n,f=ue({name:_,classes:W,props:n,className:r,style:i,classNames:a,styles:c,unstyled:o,vars:h,varsResolver:ut});return e.jsx(at,{value:{yOffset:u,scrollAreaComponent:m,getStyles:f,fullScreen:g},children:e.jsx($e,{ref:t,...f("root"),"data-full-screen":g||void 0,"data-centered":l||void 0,unstyled:o,...p})})});je.classes=W;je.displayName="@mantine/core/ModalRoot";const[ht,mt]=ys();function Ze({children:s}){const[t,n]=S.useState([]),[a,r]=S.useState(oe("modal"));return e.jsx(ht,{value:{stack:t,addModal:(i,c)=>{n(o=>[...new Set([...o,i])]),r(o=>typeof c=="number"&&typeof o=="number"?Math.max(o,c):o)},removeModal:i=>n(c=>c.filter(o=>o!==i)),getZIndex:i=>`calc(${a} + ${t.indexOf(i)} + 1)`,currentId:t[t.length-1],maxZIndex:a},children:s})}Ze.displayName="@mantine/core/ModalStack";const xt={},ve=O((s,t)=>{const n=P("ModalTitle",xt,s),{classNames:a,className:r,style:i,styles:c,vars:o,...h}=n,u=se();return e.jsx(qe,{ref:t,...u.getStyles("title",{classNames:a,style:i,styles:c,className:r}),...h})});ve.classes=W;ve.displayName="@mantine/core/ModalTitle";const ft={closeOnClickOutside:!0,withinPortal:!0,lockScroll:!0,trapFocus:!0,returnFocus:!0,closeOnEscape:!0,keepMounted:!1,zIndex:oe("modal"),transitionProps:{duration:200,transition:"fade-down"},withOverlay:!0,withCloseButton:!0},H=O((s,t)=>{const{title:n,withOverlay:a,overlayProps:r,withCloseButton:i,closeButtonProps:c,children:o,radius:h,opened:u,stackId:m,zIndex:C,...g}=P("Modal",ft,s),l=mt(),j=!!n||i,_=l&&m?{closeOnEscape:l.currentId===m,trapFocus:l.currentId===m,zIndex:l.getZIndex(m)}:{},p=a===!1?!1:m&&l?l.currentId===m:u;return S.useEffect(()=>{l&&m&&(u?l.addModal(m,C||oe("modal")):l.removeModal(m))},[u,m,C]),e.jsxs(je,{ref:t,radius:h,opened:u,zIndex:l&&m?l.getZIndex(m):C,...g,..._,children:[a&&e.jsx(ge,{visible:p,transitionProps:l&&m?{duration:0}:void 0,...r}),e.jsxs(fe,{radius:h,__hidden:l&&m&&u?m!==l.currentId:!1,children:[j&&e.jsxs(pe,{children:[n&&e.jsx(ve,{children:n}),i&&e.jsx(xe,{...c})]}),e.jsx(me,{children:o})]})]})});H.classes=W;H.displayName="@mantine/core/Modal";H.Root=je;H.Overlay=ge;H.Content=fe;H.Body=me;H.Header=pe;H.Title=ve;H.CloseButton=xe;H.Stack=Ze;const[pt,gt]=ae("Table component was not found in the tree");var ie={table:"m_b23fa0ef",th:"m_4e7aa4f3",tr:"m_4e7aa4fd",td:"m_4e7aa4ef",tbody:"m_b2404537",thead:"m_b242d975",caption:"m_9e5a3ac7",scrollContainer:"m_a100c15",scrollContainerInner:"m_62259741"};function jt(s,t){if(!t)return;const n={};return t.columnBorder&&s.withColumnBorders&&(n["data-with-column-border"]=!0),t.rowBorder&&s.withRowBorders&&(n["data-with-row-border"]=!0),t.striped&&s.striped&&(n["data-striped"]=s.striped),t.highlightOnHover&&s.highlightOnHover&&(n["data-hover"]=!0),t.captionSide&&s.captionSide&&(n["data-side"]=s.captionSide),t.stickyHeader&&s.stickyHeader&&(n["data-sticky"]=!0),n}function J(s,t){const n=`Table${s.charAt(0).toUpperCase()}${s.slice(1)}`,a=O((r,i)=>{const c=P(n,{},r),{classNames:o,className:h,style:u,styles:m,...C}=c,g=gt();return e.jsx(V,{component:s,ref:i,...jt(g,t),...g.getStyles(s,{className:h,classNames:o,style:u,styles:m,props:c}),...C})});return a.displayName=`@mantine/core/${n}`,a.classes=ie,a}const _e=J("th",{columnBorder:!0}),Xe=J("td",{columnBorder:!0}),de=J("tr",{rowBorder:!0,striped:!0,highlightOnHover:!0}),Ke=J("thead",{stickyHeader:!0}),Ye=J("tbody"),Je=J("tfoot"),Qe=J("caption",{captionSide:!0});function Me({data:s}){return e.jsxs(e.Fragment,{children:[s.caption&&e.jsx(Qe,{children:s.caption}),s.head&&e.jsx(Ke,{children:e.jsx(de,{children:s.head.map((t,n)=>e.jsx(_e,{children:t},n))})}),s.body&&e.jsx(Ye,{children:s.body.map((t,n)=>e.jsx(de,{children:t.map((a,r)=>e.jsx(Xe,{children:a},r))},n))}),s.foot&&e.jsx(Je,{children:e.jsx(de,{children:s.foot.map((t,n)=>e.jsx(_e,{children:t},n))})})]})}Me.displayName="@mantine/core/TableDataRenderer";const vt={type:"scrollarea"},yt=he((s,{minWidth:t,type:n})=>({scrollContainer:{"--table-min-width":X(t),"--table-overflow":n==="native"?"auto":void 0}})),Ae=O((s,t)=>{const n=P("TableScrollContainer",vt,s),{classNames:a,className:r,style:i,styles:c,unstyled:o,vars:h,children:u,minWidth:m,type:C,...g}=n,l=ue({name:"TableScrollContainer",classes:ie,props:n,className:r,style:i,classNames:a,styles:c,unstyled:o,vars:h,varsResolver:yt,rootSelector:"scrollContainer"});return e.jsx(V,{component:C==="scrollarea"?bs:"div",...C==="scrollarea"?{offsetScrollbars:"x"}:{},ref:t,...l("scrollContainer"),...g,children:e.jsx("div",{...l("scrollContainerInner"),children:u})})});Ae.classes=ie;Ae.displayName="@mantine/core/TableScrollContainer";const bt={withRowBorders:!0,verticalSpacing:7},Ct=he((s,{layout:t,captionSide:n,horizontalSpacing:a,verticalSpacing:r,borderColor:i,stripedColor:c,highlightOnHoverColor:o,striped:h,highlightOnHover:u,stickyHeaderOffset:m,stickyHeader:C})=>({table:{"--table-layout":t,"--table-caption-side":n,"--table-horizontal-spacing":be(a),"--table-vertical-spacing":be(r),"--table-border-color":i?ye(i,s):void 0,"--table-striped-color":h&&c?ye(c,s):void 0,"--table-highlight-on-hover-color":u&&o?ye(o,s):void 0,"--table-sticky-header-offset":C?X(m):void 0}})),x=O((s,t)=>{const n=P("Table",bt,s),{classNames:a,className:r,style:i,styles:c,unstyled:o,vars:h,horizontalSpacing:u,verticalSpacing:m,captionSide:C,stripedColor:g,highlightOnHoverColor:l,striped:j,highlightOnHover:_,withColumnBorders:p,withRowBorders:f,withTableBorder:w,borderColor:A,layout:y,variant:T,data:R,children:N,stickyHeader:I,stickyHeaderOffset:M,mod:F,tabularNums:Z,...d}=n,D=ue({name:"Table",props:n,className:r,style:i,classes:ie,classNames:a,styles:c,unstyled:o,rootSelector:"table",vars:h,varsResolver:Ct});return e.jsx(pt,{value:{getStyles:D,stickyHeader:I,striped:j===!0?"odd":j||void 0,highlightOnHover:_,withColumnBorders:p,withRowBorders:f,captionSide:C||"bottom"},children:e.jsx(V,{component:"table",variant:T,ref:t,mod:[{"data-with-table-border":w,"data-tabular-nums":Z},F],...D("table"),...d,children:N||!!R&&e.jsx(Me,{data:R})})})});x.classes=ie;x.displayName="@mantine/core/Table";x.Td=Xe;x.Th=_e;x.Tr=de;x.Thead=Ke;x.Tbody=Ye;x.Tfoot=Je;x.Caption=Qe;x.ScrollContainer=Ae;x.DataRenderer=Me;/**
 * @license @tabler/icons-react v3.29.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var _t=le("outline","devices","IconDevices",[["path",{d:"M13 9a1 1 0 0 1 1 -1h6a1 1 0 0 1 1 1v10a1 1 0 0 1 -1 1h-6a1 1 0 0 1 -1 -1v-10z",key:"svg-0"}],["path",{d:"M18 8v-3a1 1 0 0 0 -1 -1h-13a1 1 0 0 0 -1 1v12a1 1 0 0 0 1 1h9",key:"svg-1"}],["path",{d:"M16 9h2",key:"svg-2"}]]);/**
 * @license @tabler/icons-react v3.29.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var es=le("outline","edit","IconEdit",[["path",{d:"M7 7h-1a2 2 0 0 0 -2 2v9a2 2 0 0 0 2 2h9a2 2 0 0 0 2 -2v-1",key:"svg-0"}],["path",{d:"M20.385 6.585a2.1 2.1 0 0 0 -2.97 -2.97l-8.415 8.385v3h3l8.385 -8.415z",key:"svg-1"}],["path",{d:"M16 5l3 3",key:"svg-2"}]]);/**
 * @license @tabler/icons-react v3.29.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var St=le("outline","file-export","IconFileExport",[["path",{d:"M14 3v4a1 1 0 0 0 1 1h4",key:"svg-0"}],["path",{d:"M11.5 21h-4.5a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v5m-5 6h7m-3 -3l3 3l-3 3",key:"svg-1"}]]);/**
 * @license @tabler/icons-react v3.29.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var ss=le("outline","plus","IconPlus",[["path",{d:"M12 5l0 14",key:"svg-0"}],["path",{d:"M5 12l14 0",key:"svg-1"}]]);/**
 * @license @tabler/icons-react v3.29.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var ts=le("outline","trash","IconTrash",[["path",{d:"M4 7l16 0",key:"svg-0"}],["path",{d:"M10 11l0 6",key:"svg-1"}],["path",{d:"M14 11l0 6",key:"svg-2"}],["path",{d:"M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12",key:"svg-3"}],["path",{d:"M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3",key:"svg-4"}]]);const Tt=({config:s,onChange:t})=>{const n=a=>{t({...s,...a})};return e.jsx(q,{gap:"md",children:e.jsxs(v,{children:[e.jsx(v.Col,{span:6,children:e.jsx(Y,{label:"Baud Rate",value:String(s.baud_rate),onChange:a=>n({baud_rate:Number(a)}),data:Ms.map(a=>({value:String(a),label:String(a)})),required:!0})}),e.jsx(v.Col,{span:6,children:e.jsx(Y,{label:"Data Bits",value:String(s.data_bits),onChange:a=>n({data_bits:Number(a)}),data:As.map(a=>({value:String(a.value),label:a.label})),required:!0})}),e.jsx(v.Col,{span:6,children:e.jsx(Y,{label:"Parity",value:s.parity,onChange:a=>n({parity:a}),data:Rs.map(a=>({value:a.value,label:a.label})),required:!0})}),e.jsx(v.Col,{span:6,children:e.jsx(Y,{label:"Stop Bits",value:String(s.stop_bits),onChange:a=>n({stop_bits:Number(a)}),data:Bs.map(a=>({value:String(a.value),label:a.label})),required:!0})}),e.jsx(v.Col,{span:6,children:e.jsx(K,{label:"Timeout (ms)",value:s.timeout_ms,onChange:a=>n({timeout_ms:Number(a)}),min:100,max:5e3,step:100,required:!0})})]})})},wt=({slaves:s,onEdit:t,onDelete:n,onAdd:a})=>{const r=Cs(),i=_s({uuid:"4880c12c-fdcb-4077-8920-a450d7f9b907"}),{characteristic:c}=i.useBluetoothCharacteristic({uuid:"fec26ec4-6d71-4442-9f81-55bc21d658d6"}),[o,h]=S.useState(null),[u,m]=S.useState({}),C=async(g,l)=>{var _,p;if(!r.isConnected){$.show({message:"Not connected to device. Please connect via Bluetooth first.",color:"red"});return}if(!c){$.show({message:"Bluetooth characteristic not available. Please reconnect.",color:"red"});return}const j=`${g.slave_id}-${l.reg_id}`;h(j);try{const w=await new ws(c).readRegisterLive(g.slave_id,l.address,l.length,l.function_code);if(w.status==="success"&&w.data){const A=w.data,y=A.raw_values||[],T=A.timestamp||new Date().toISOString();let R;const N=A.interpretations;if(y.length>=2&&N){let I;const M=((_=l.data_type)==null?void 0:_.toLowerCase())||"uint16",F=((p=l.endianness)==null?void 0:p.toLowerCase())||"big";if(M.includes("float"))switch(F){case"big":I=N.float32_big_endian_ABCD;break;case"little":I=N.float32_little_endian_DCBA;break;case"mid_big":I=N.float32_mid_big_BADC;break;case"mid_little":I=N.float32_mid_little_CDAB;break;default:I=N.float32_big_endian_ABCD}else(M.includes("int32")||M.includes("uint32"))&&(F==="big"||F==="mid_big"?I=M.includes("uint")?N.uint32_big_endian:N.int32_big_endian:I=M.includes("uint")?N.uint32_little_endian:N.int32_little_endian);I!==void 0&&!isNaN(I)&&isFinite(I)?R=`${(I*(l.scale_factor||1)+(l.offset||0)).toFixed(4)} ${l.unit||""}`.trim():R="Invalid float value"}else y.length>0?R=`${(y[0]*(l.scale_factor||1)+(l.offset||0)).toFixed(2)} ${l.unit||""}`.trim():R="No data";m({...u,[j]:{value:R,rawValues:y,rawHex:A.raw_hex,hexValues:A.hex_values,interpretations:N,timestamp:T}}),$.show({message:`Successfully read ${l.name}: ${R}`,color:"green"})}else throw new Error(w.message||"Failed to read register")}catch(f){$.show({message:`Failed to read register: ${f.message||f}`,color:"red"}),console.error("Read register error:",f)}finally{h(null)}};return e.jsxs(q,{gap:"md",children:[s.length===0&&e.jsx(b,{c:"dimmed",ta:"center",py:"xl",children:'No Modbus slaves configured. Click "Add Slave" to get started.'}),s.map(g=>e.jsxs(Ss,{withBorder:!0,padding:"md",children:[e.jsxs(B,{justify:"space-between",mb:"xs",children:[e.jsxs(B,{children:[e.jsxs(b,{fw:600,size:"lg",children:["Slave ID ",g.slave_id,": ",g.name]}),e.jsx(De,{color:g.enabled?"green":"gray",children:g.enabled?"Enabled":"Disabled"})]}),e.jsxs(B,{gap:"xs",children:[e.jsx(ce,{variant:"light",color:"blue",onClick:()=>t(g),"aria-label":"Edit slave",children:e.jsx(es,{size:16})}),e.jsx(ce,{variant:"light",color:"red",onClick:()=>n(g.slave_id),"aria-label":"Delete slave",children:e.jsx(ts,{size:16})})]})]}),e.jsxs(b,{size:"sm",c:"dimmed",children:[e.jsx("strong",{children:"Type:"})," ",g.device_type]}),e.jsxs(b,{size:"sm",c:"dimmed",mb:"md",children:[e.jsx("strong",{children:"Registers:"})," ",g.registers.length," configured"]}),g.registers.length>0&&e.jsx(z,{variant:"separated",children:g.registers.map((l,j)=>{var w,A,y,T,R,N;const _=`${g.slave_id}-${l.reg_id}`,p=o===_,f=u[_];return e.jsxs(z.Item,{value:`reg-${g.slave_id}-${j}`,children:[e.jsx(z.Control,{children:e.jsxs(B,{justify:"space-between",wrap:"nowrap",children:[e.jsxs("div",{children:[e.jsx(b,{size:"sm",fw:500,children:l.name}),e.jsxs(b,{size:"xs",c:"dimmed",children:["Addr: ",l.address," | FC: ",l.function_code," | Type:"," ",l.data_type]})]}),e.jsx(De,{size:"sm",color:l.enabled?"green":"gray",children:l.enabled?"ON":"OFF"})]})}),e.jsx(z.Panel,{children:e.jsxs(q,{gap:"xs",children:[e.jsxs(v,{children:[e.jsx(v.Col,{span:6,children:e.jsxs(b,{size:"xs",c:"dimmed",children:["Register ID: ",l.reg_id]})}),e.jsx(v.Col,{span:6,children:e.jsxs(b,{size:"xs",c:"dimmed",children:["Address: ",l.address]})}),e.jsx(v.Col,{span:6,children:e.jsxs(b,{size:"xs",c:"dimmed",children:["Length: ",l.length," registers"]})}),e.jsx(v.Col,{span:6,children:e.jsxs(b,{size:"xs",c:"dimmed",children:["Function Code: ",l.function_code]})}),e.jsx(v.Col,{span:6,children:e.jsxs(b,{size:"xs",c:"dimmed",children:["Data Type: ",l.data_type]})}),e.jsx(v.Col,{span:6,children:e.jsxs(b,{size:"xs",c:"dimmed",children:["Endianness: ",l.endianness]})}),e.jsx(v.Col,{span:6,children:e.jsxs(b,{size:"xs",c:"dimmed",children:["Scale: ",l.scale_factor||1]})}),e.jsx(v.Col,{span:6,children:e.jsxs(b,{size:"xs",c:"dimmed",children:["Offset: ",l.offset||0]})}),l.unit&&e.jsx(v.Col,{span:6,children:e.jsxs(b,{size:"xs",c:"dimmed",children:["Unit: ",l.unit]})})]}),e.jsxs(B,{justify:"space-between",mt:"xs",children:[e.jsx(Ps,{label:"Read live data from this register via RS485",children:e.jsx(L,{size:"xs",variant:"light",leftSection:p?e.jsx(Ts,{size:14}):e.jsx(ks,{size:14}),onClick:()=>C(g,l),disabled:p||!r.isConnected,children:p?"Reading...":"Read Live"})}),f&&e.jsxs(b,{size:"sm",fw:500,c:"green",children:["âœ“ ",f.value]})]}),f&&e.jsx(Pe,{withBorder:!0,p:"xs",mt:"sm",bg:"gray.0",children:e.jsxs(q,{gap:"xs",children:[e.jsx(b,{size:"xs",fw:600,c:"blue",children:"ðŸ” Debug Information"}),e.jsxs(B,{gap:"xs",children:[e.jsx(b,{size:"xs",c:"dimmed",children:"Raw Values (DEC):"}),e.jsx(k,{fz:"xs",children:((w=f.rawValues)==null?void 0:w.join(", "))||"N/A"})]}),f.rawHex&&e.jsxs(B,{gap:"xs",children:[e.jsx(b,{size:"xs",c:"dimmed",children:"Raw Values (HEX):"}),e.jsx(k,{fz:"xs",c:"blue",children:f.rawHex})]}),f.hexValues&&e.jsxs(B,{gap:"xs",children:[e.jsx(b,{size:"xs",c:"dimmed",children:"Registers:"}),f.hexValues.map((I,M)=>e.jsxs(k,{fz:"xs",children:["Reg",M,": 0x",I]},M))]}),((A=f.interpretations)==null?void 0:A.raw_bytes)&&e.jsxs(B,{gap:"xs",children:[e.jsx(b,{size:"xs",c:"dimmed",children:"Raw Bytes:"}),e.jsx(k,{fz:"xs",c:"orange",children:f.interpretations.raw_bytes})]}),f.interpretations&&e.jsxs(e.Fragment,{children:[e.jsx(Ce,{my:"xs",label:"Float32 Interpretations",labelPosition:"left"}),e.jsxs(x,{withTableBorder:!0,children:[e.jsx(x.Thead,{children:e.jsxs(x.Tr,{children:[e.jsx(x.Th,{children:"Format"}),e.jsx(x.Th,{children:"Value"})]})}),e.jsxs(x.Tbody,{children:[e.jsxs(x.Tr,{children:[e.jsx(x.Td,{children:e.jsx(k,{fz:"xs",children:"Big Endian (ABCD)"})}),e.jsx(x.Td,{fw:500,children:((y=f.interpretations.float32_big_endian_ABCD)==null?void 0:y.toFixed(6))??"N/A"})]}),e.jsxs(x.Tr,{children:[e.jsx(x.Td,{children:e.jsx(k,{fz:"xs",children:"Little Endian (DCBA)"})}),e.jsx(x.Td,{fw:500,children:((T=f.interpretations.float32_little_endian_DCBA)==null?void 0:T.toFixed(6))??"N/A"})]}),e.jsxs(x.Tr,{children:[e.jsx(x.Td,{children:e.jsx(k,{fz:"xs",children:"Mid-Big (BADC)"})}),e.jsx(x.Td,{fw:500,children:((R=f.interpretations.float32_mid_big_BADC)==null?void 0:R.toFixed(6))??"N/A"})]}),e.jsxs(x.Tr,{children:[e.jsx(x.Td,{children:e.jsx(k,{fz:"xs",children:"Mid-Little (CDAB)"})}),e.jsx(x.Td,{fw:500,children:((N=f.interpretations.float32_mid_little_CDAB)==null?void 0:N.toFixed(6))??"N/A"})]})]})]}),e.jsx(Ce,{my:"xs",label:"Integer Interpretations",labelPosition:"left"}),e.jsxs(x,{withTableBorder:!0,children:[e.jsx(x.Thead,{children:e.jsxs(x.Tr,{children:[e.jsx(x.Th,{children:"Format"}),e.jsx(x.Th,{children:"Value"})]})}),e.jsxs(x.Tbody,{children:[e.jsxs(x.Tr,{children:[e.jsx(x.Td,{children:e.jsx(k,{fz:"xs",children:"UInt32 BE"})}),e.jsx(x.Td,{children:f.interpretations.uint32_big_endian??"N/A"})]}),e.jsxs(x.Tr,{children:[e.jsx(x.Td,{children:e.jsx(k,{fz:"xs",children:"UInt32 LE"})}),e.jsx(x.Td,{children:f.interpretations.uint32_little_endian??"N/A"})]}),e.jsxs(x.Tr,{children:[e.jsx(x.Td,{children:e.jsx(k,{fz:"xs",children:"Int32 BE"})}),e.jsx(x.Td,{children:f.interpretations.int32_big_endian??"N/A"})]}),e.jsxs(x.Tr,{children:[e.jsx(x.Td,{children:e.jsx(k,{fz:"xs",children:"Int32 LE"})}),e.jsx(x.Td,{children:f.interpretations.int32_little_endian??"N/A"})]}),e.jsxs(x.Tr,{children:[e.jsx(x.Td,{children:e.jsx(k,{fz:"xs",children:"UInt16 Reg0"})}),e.jsx(x.Td,{children:f.interpretations.uint16_reg0??"N/A"})]}),e.jsxs(x.Tr,{children:[e.jsx(x.Td,{children:e.jsx(k,{fz:"xs",children:"UInt16 Reg1"})}),e.jsx(x.Td,{children:f.interpretations.uint16_reg1??"N/A"})]}),e.jsxs(x.Tr,{children:[e.jsx(x.Td,{children:e.jsx(k,{fz:"xs",children:"Int16 Reg0"})}),e.jsx(x.Td,{children:f.interpretations.int16_reg0??"N/A"})]}),e.jsxs(x.Tr,{children:[e.jsx(x.Td,{children:e.jsx(k,{fz:"xs",children:"Int16 Reg1"})}),e.jsx(x.Td,{children:f.interpretations.int16_reg1??"N/A"})]})]})]})]}),e.jsxs(b,{size:"xs",c:"dimmed",children:["Read at: ",new Date(f.timestamp).toLocaleString()]})]})})]})})]},j)})}),g.registers.length===0&&e.jsx(b,{size:"sm",c:"dimmed",ta:"center",py:"md",children:"No registers configured for this slave"})]},g.slave_id)),e.jsx(L,{leftSection:e.jsx(ss,{size:16}),onClick:a,fullWidth:!0,children:"Add Slave Device"})]})},It=({opened:s,onClose:t,onSave:n,slave:a,existingSlaveIds:r})=>{const i=!!a,[c,o]=S.useState(!1),[h,u]=S.useState(1),[m,C]=S.useState(""),[g,l]=S.useState(""),[j,_]=S.useState(!0),[p,f]=S.useState([]),[w,A]=S.useState(null),[y,T]=S.useState({});S.useEffect(()=>{a?(u(a.slave_id),C(a.name),l(a.device_type),_(a.enabled),f(a.registers||[])):(u(1),C(""),l(""),_(!0),f([])),A(null),T({})},[a,s]);const R=()=>{A(-1),T({reg_id:"",name:"",enabled:!0,address:0,length:1,function_code:3,data_type:"uint16",endianness:"big",scale_factor:1,offset:0,unit:""})},N=d=>{A(d),T({...p[d]})},I=()=>{if(!y.reg_id||!y.name){$.show({message:"Register ID and Name are required",color:"red"});return}if(p.some((E,te)=>E.reg_id===y.reg_id&&te!==w)){$.show({message:"Register ID must be unique",color:"red"});return}const D=y;if(w===-1)f([...p,D]);else if(w!==null){const E=[...p];E[w]=D,f(E)}A(null),T({})},M=d=>{window.confirm(`Delete register "${p[d].name}"?`)&&f(p.filter((E,te)=>te!==d))},F=()=>{A(null),T({})},Z=async()=>{if(!m.trim()){$.show({message:"Slave name is required",color:"red"});return}if(h<U.SLAVE_ID_MIN||h>U.SLAVE_ID_MAX){$.show({message:`Slave ID must be between ${U.SLAVE_ID_MIN} and ${U.SLAVE_ID_MAX}`,color:"red"});return}if((!i||a.slave_id!==h)&&r.includes(h)){$.show({message:`Slave ID ${h} is already in use`,color:"red"});return}if(!(p.length===0&&!window.confirm("No registers configured. Do you want to save anyway?"))){o(!0);try{const d={slave_id:h,name:m.trim(),device_type:g.trim(),enabled:j,registers:p};await n(d),$.show({message:`Slave ${i?"updated":"added"} successfully`,color:"green"}),t()}catch{}finally{o(!1)}}};return e.jsx(H,{opened:s,onClose:t,title:e.jsx(b,{size:"lg",fw:600,children:i?"Edit Modbus Slave":"Add Modbus Slave"}),size:"xl",closeOnClickOutside:!1,children:e.jsxs(q,{gap:"md",children:[e.jsxs(v,{children:[e.jsx(v.Col,{span:6,children:e.jsx(K,{label:"Slave ID",value:h,onChange:d=>u(Number(d)),min:U.SLAVE_ID_MIN,max:U.SLAVE_ID_MAX,required:!0,disabled:i,description:i?"Slave ID cannot be changed":"1-247"})}),e.jsx(v.Col,{span:6,children:e.jsx(ne,{label:"Slave Name",value:m,onChange:d=>C(d.currentTarget.value),required:!0,placeholder:"e.g., Energy Meter"})}),e.jsx(v.Col,{span:6,children:e.jsx(ne,{label:"Device Type",value:g,onChange:d=>l(d.currentTarget.value),placeholder:"e.g., energy_meter"})}),e.jsx(v.Col,{span:12,children:e.jsx(Be,{label:"Enabled",checked:j,onChange:d=>_(d.currentTarget.checked),description:"Enable/disable polling for this slave"})})]}),e.jsx(Ce,{label:"Registers Configuration",labelPosition:"center"}),e.jsxs(q,{gap:"xs",children:[e.jsxs(B,{justify:"space-between",children:[e.jsxs(b,{size:"sm",fw:500,children:["Configured Registers (",p.length,")"]}),e.jsx(L,{leftSection:e.jsx(ss,{size:16}),onClick:R,size:"xs",disabled:w!==null,children:"Add Register"})]}),w!==null&&e.jsxs(q,{gap:"xs",p:"md",style:{border:"1px solid var(--mantine-color-blue-4)",borderRadius:"var(--mantine-radius-md)",backgroundColor:"var(--mantine-color-blue-0)"},children:[e.jsx(b,{size:"sm",fw:600,c:"blue",children:w===-1?"New Register":"Edit Register"}),e.jsxs(v,{children:[e.jsx(v.Col,{span:6,children:e.jsx(ne,{label:"Register ID",value:y.reg_id||"",onChange:d=>T({...y,reg_id:d.currentTarget.value}),required:!0,placeholder:"e.g., voltage_l1"})}),e.jsx(v.Col,{span:6,children:e.jsx(ne,{label:"Name",value:y.name||"",onChange:d=>T({...y,name:d.currentTarget.value}),required:!0,placeholder:"e.g., Voltage L1"})}),e.jsx(v.Col,{span:4,children:e.jsx(K,{label:"Address",value:y.address||0,onChange:d=>T({...y,address:Number(d)}),min:U.REGISTER_ADDRESS_MIN,max:U.REGISTER_ADDRESS_MAX})}),e.jsx(v.Col,{span:4,children:e.jsx(K,{label:"Length",value:y.length||1,onChange:d=>T({...y,length:Number(d)}),min:U.REGISTER_LENGTH_MIN,max:U.REGISTER_LENGTH_MAX})}),e.jsx(v.Col,{span:4,children:e.jsx(Y,{label:"Function Code",value:String(y.function_code||3),onChange:d=>T({...y,function_code:Number(d)}),data:zs.map(d=>({value:String(d.value),label:d.label}))})}),e.jsx(v.Col,{span:6,children:e.jsx(Y,{label:"Data Type",value:y.data_type||"uint16",onChange:d=>T({...y,data_type:d}),data:Ds.map(d=>({value:d.value,label:d.label}))})}),e.jsx(v.Col,{span:6,children:e.jsx(Y,{label:"Endianness",value:y.endianness||"big",onChange:d=>T({...y,endianness:d}),data:Es.map(d=>({value:d.value,label:d.label}))})}),e.jsx(v.Col,{span:4,children:e.jsx(K,{label:"Scale Factor",value:y.scale_factor||1,onChange:d=>T({...y,scale_factor:Number(d)}),step:.1,decimalScale:4})}),e.jsx(v.Col,{span:4,children:e.jsx(K,{label:"Offset",value:y.offset||0,onChange:d=>T({...y,offset:Number(d)}),step:.1,decimalScale:4})}),e.jsx(v.Col,{span:4,children:e.jsx(ne,{label:"Unit",value:y.unit||"",onChange:d=>T({...y,unit:d.currentTarget.value}),placeholder:"e.g., V, A, W"})}),e.jsx(v.Col,{span:12,children:e.jsx(Be,{label:"Enabled",checked:y.enabled!==!1,onChange:d=>T({...y,enabled:d.currentTarget.checked})})})]}),e.jsxs(B,{justify:"flex-end",gap:"xs",children:[e.jsx(L,{variant:"light",onClick:F,size:"xs",children:"Cancel"}),e.jsxs(L,{onClick:I,size:"xs",children:[w===-1?"Add":"Update"," Register"]})]})]}),p.length>0&&e.jsx(z,{variant:"contained",children:p.map((d,D)=>e.jsxs(z.Item,{value:`reg-${D}`,children:[e.jsx(z.Control,{children:e.jsx(B,{justify:"space-between",wrap:"nowrap",children:e.jsxs("div",{children:[e.jsx(b,{size:"sm",fw:500,children:d.name}),e.jsxs(b,{size:"xs",c:"dimmed",children:["ID: ",d.reg_id," | Addr: ",d.address," | FC: ",d.function_code," |"," ",d.data_type]})]})})}),e.jsx(z.Panel,{children:e.jsxs(q,{gap:"xs",children:[e.jsxs(v,{children:[e.jsx(v.Col,{span:6,children:e.jsxs(b,{size:"xs",c:"dimmed",children:["Address: ",d.address]})}),e.jsx(v.Col,{span:6,children:e.jsxs(b,{size:"xs",c:"dimmed",children:["Length: ",d.length]})}),e.jsx(v.Col,{span:6,children:e.jsxs(b,{size:"xs",c:"dimmed",children:["Function Code: ",d.function_code]})}),e.jsx(v.Col,{span:6,children:e.jsxs(b,{size:"xs",c:"dimmed",children:["Data Type: ",d.data_type]})}),e.jsx(v.Col,{span:6,children:e.jsxs(b,{size:"xs",c:"dimmed",children:["Scale: ",d.scale_factor||1]})}),e.jsx(v.Col,{span:6,children:e.jsxs(b,{size:"xs",c:"dimmed",children:["Offset: ",d.offset||0]})}),e.jsx(v.Col,{span:6,children:e.jsxs(b,{size:"xs",c:"dimmed",children:["Unit: ",d.unit||"N/A"]})}),e.jsx(v.Col,{span:6,children:e.jsxs(b,{size:"xs",c:"dimmed",children:["Enabled: ",d.enabled?"Yes":"No"]})})]}),e.jsxs(B,{gap:"xs",children:[e.jsx(ce,{variant:"light",color:"blue",onClick:()=>N(D),disabled:w!==null,children:e.jsx(es,{size:16})}),e.jsx(ce,{variant:"light",color:"red",onClick:()=>M(D),disabled:w!==null,children:e.jsx(ts,{size:16})})]})]})})]},D))}),p.length===0&&w===null&&e.jsx(b,{size:"sm",c:"dimmed",ta:"center",py:"md",children:'No registers configured. Click "Add Register" to add one.'})]}),e.jsxs(B,{justify:"flex-end",mt:"md",children:[e.jsx(L,{variant:"light",onClick:t,disabled:c,children:"Cancel"}),e.jsxs(L,{onClick:Z,loading:c,children:[i?"Update":"Add"," Slave"]})]})]})})},Dt=()=>{const s=$s(),[t,n]=S.useState(null),[a,r]=S.useState(!1),[i,c]=S.useState(null);S.useEffect(()=>{s.modbusConfig&&n(s.modbusConfig)},[s.modbusConfig]);const o=async()=>{if(!t){$.show({message:"No configuration to save",color:"red"});return}try{await s.saveModbusConfig({uart_config:t.uart_config,retry_count:t.retry_count})}catch{}},h=async j=>{if(window.confirm(`Are you sure you want to delete Slave ID ${j}? This action cannot be undone.`))try{await s.deleteSlave(j)}catch{}},u=j=>{c(j),r(!0)},m=()=>{c(null),r(!0)},C=()=>{r(!1),c(null)},g=async j=>{if(j)try{const _=await j.text(),p=JSON.parse(_),f=p.modbus_config||p;if(!f.uart_config){$.show({message:"Invalid configuration file: missing uart_config",color:"red"});return}await s.importModbusConfig(f)}catch(_){$.show({message:`Failed to import: ${_ instanceof Error?_.message:"Invalid JSON file"}`,color:"red"})}},l=async j=>{i?await s.updateSlave(j.slave_id,j):await s.addSlave(j),await s.loadModbusConfig()};return e.jsxs(q,{gap:"md",children:[e.jsxs(B,{justify:"space-between",children:[e.jsx(b,{size:"xl",fw:700,children:"Modbus Configuration"}),e.jsxs(B,{children:[e.jsx(L,{variant:"light",leftSection:e.jsx(Fs,{size:16}),onClick:()=>s.loadModbusConfig(),loading:s.isLoading,children:"Get Config"}),e.jsx(L,{variant:"light",color:"teal",leftSection:e.jsx(St,{size:16}),onClick:()=>s.exportModbusConfig(),disabled:!t,children:"Export"}),e.jsx(We,{onChange:g,accept:"application/json,.json",children:j=>e.jsx(L,{variant:"light",color:"orange",leftSection:e.jsx(Os,{size:16}),loading:s.isLoading,...j,children:"Import"})})]})]}),!t&&!s.isLoading&&e.jsx(b,{c:"dimmed",ta:"center",py:"xl",children:'Click "Get Config" to load current Modbus configuration'}),t&&e.jsxs(e.Fragment,{children:[e.jsxs(ze,{title:"UART Configuration",icon:e.jsx(Is,{size:20}),children:[e.jsx(Tt,{config:t.uart_config,onChange:j=>n({...t,uart_config:j})}),e.jsx(v,{mt:"md",children:e.jsx(v.Col,{span:12,children:e.jsx(K,{label:"Retry Count",value:t.retry_count,onChange:j=>n({...t,retry_count:Number(j)}),min:1,max:10,description:"Number of retries on communication failure"})})}),e.jsx(B,{justify:"flex-end",mt:"md",children:e.jsx(L,{onClick:o,loading:s.isLoading,children:"Save UART Config"})})]}),e.jsx(ze,{title:"Modbus Slave Devices",icon:e.jsx(_t,{size:20}),children:e.jsx(wt,{slaves:t.slaves||[],onEdit:u,onDelete:h,onAdd:m})})]}),e.jsx(It,{opened:a,onClose:C,onSave:l,slave:i,existingSlaveIds:((t==null?void 0:t.slaves)||[]).map(j=>j.slave_id)})]})};export{Dt as default};
