import{C as oe,w as C,D as as,e as De,E as os,F as ls,j as e,O as rs,R as is,B as H,H as _e,J as ds,K as le,L as Q,M as cs,N as Pe,P as us,Q as ke,V as hs,r as Z,f as F,u as k,U as ms,W as xs,h as ps,a as ue,X as ze,d as he,g as Oe,Y as fs,Z as gs,_ as js,n as vs,c as ys,$ as bs,k as ye,s as se,S as G,G as y,v as Y,a0 as _s,a1 as Cs,T as b,a2 as Ss,x as E,a3 as ce,a4 as Ts,y as V,a5 as ws,A as O,a6 as Is,t as Ce,a7 as Ms,a8 as Rs}from"./index-D1Sx8b-i.js";import{a as Ns,T as ae,C as be}from"./ConfigCard-DoJIrFgo.js";import{B as As,D as Es,P as Bs,S as zs,V as $,F as Ds,a as Ps,E as ks}from"./configOptions-DaY-HE-t.js";import{N as K,B as Se,I as Os,C as P,D as Te}from"./IconRefresh-D5hMuc4W.js";import{u as $s,I as Fs}from"./useConfiguration-DXP-7dAn.js";import{I as Ls}from"./IconUpload-COAwluOZ.js";const[Vs,q]=oe("ModalBase component was not found in tree");function Hs({opened:s,transitionDuration:t}){const[n,a]=C.useState(s),r=C.useRef(-1),c=as()?0:t;return C.useEffect(()=>(s?(a(!0),window.clearTimeout(r.current)):c===0?a(!1):r.current=window.setTimeout(()=>a(!1),c),()=>window.clearTimeout(r.current)),[s,c]),n}function Us({id:s,transitionProps:t,opened:n,trapFocus:a,closeOnEscape:r,onClose:i,returnFocus:c}){const o=De(s),[h,u]=C.useState(!1),[m,_]=C.useState(!1),v=typeof(t==null?void 0:t.duration)=="number"?t==null?void 0:t.duration:200,l=Hs({opened:n,transitionDuration:v});return os("keydown",I=>{var T;I.key==="Escape"&&r&&n&&((T=I.target)==null?void 0:T.getAttribute("data-mantine-stop-propagation"))!=="true"&&i()},{capture:!0}),ls({opened:n,shouldReturnFocus:a&&c}),{_id:o,titleMounted:h,bodyMounted:m,shouldLockScroll:l,setTitleMounted:u,setBodyMounted:_}}const $e=C.forwardRef(({keepMounted:s,opened:t,onClose:n,id:a,transitionProps:r,onExitTransitionEnd:i,onEnterTransitionEnd:c,trapFocus:o,closeOnEscape:h,returnFocus:u,closeOnClickOutside:m,withinPortal:_,portalProps:v,lockScroll:l,children:I,zIndex:T,shadow:f,padding:p,__vars:w,unstyled:g,removeScrollProps:j,...S},A)=>{const{_id:R,titleMounted:M,bodyMounted:N,shouldLockScroll:L,setTitleMounted:W,setBodyMounted:d}=Us({id:a,transitionProps:r,opened:t,trapFocus:o,closeOnEscape:h,onClose:n,returnFocus:u}),{key:z,...D}=j||{};return e.jsx(rs,{...v,withinPortal:_,children:e.jsx(Vs,{value:{opened:t,onClose:n,closeOnClickOutside:m,onExitTransitionEnd:i,onEnterTransitionEnd:c,transitionProps:{...r,keepMounted:s},getTitleId:()=>`${R}-title`,getBodyId:()=>`${R}-body`,titleMounted:M,bodyMounted:N,setTitleMounted:W,setBodyMounted:d,trapFocus:o,closeOnEscape:h,zIndex:T,unstyled:g},children:e.jsx(is,{enabled:L&&l,...D,children:e.jsx(H,{ref:A,...S,__vars:{...w,"--mb-z-index":(T||le("modal")).toString(),"--mb-shadow":ds(f),"--mb-padding":_e(p)},children:I})},z)})})});$e.displayName="@mantine/core/ModalBase";function Gs(){const s=q();return C.useEffect(()=>(s.setBodyMounted(!0),()=>s.setBodyMounted(!1)),[]),s.getBodyId()}var ee={title:"m_615af6c9",header:"m_b5489c3c",inner:"m_60c222c7",content:"m_fd1ab0aa",close:"m_606cb269",body:"m_5df29311"};const Fe=C.forwardRef(({className:s,...t},n)=>{const a=Gs(),r=q();return e.jsx(H,{ref:n,...t,id:a,className:Q({[ee.body]:!r.unstyled},s)})});Fe.displayName="@mantine/core/ModalBaseBody";const Le=C.forwardRef(({className:s,onClick:t,...n},a)=>{const r=q();return e.jsx(cs,{ref:a,...n,onClick:i=>{r.onClose(),t==null||t(i)},className:Q({[ee.close]:!r.unstyled},s),unstyled:r.unstyled})});Le.displayName="@mantine/core/ModalBaseCloseButton";const Ve=C.forwardRef(({transitionProps:s,className:t,innerProps:n,onKeyDown:a,style:r,...i},c)=>{const o=q();return e.jsx(Pe,{mounted:o.opened,transition:"pop",...o.transitionProps,onExited:()=>{var h,u,m;(h=o.onExitTransitionEnd)==null||h.call(o),(m=(u=o.transitionProps)==null?void 0:u.onExited)==null||m.call(u)},onEntered:()=>{var h,u,m;(h=o.onEnterTransitionEnd)==null||h.call(o),(m=(u=o.transitionProps)==null?void 0:u.onEntered)==null||m.call(u)},...s,children:h=>e.jsx("div",{...n,className:Q({[ee.inner]:!o.unstyled},n.className),children:e.jsx(us,{active:o.opened&&o.trapFocus,innerRef:c,children:e.jsx(ke,{...i,component:"section",role:"dialog",tabIndex:-1,"aria-modal":!0,"aria-describedby":o.bodyMounted?o.getBodyId():void 0,"aria-labelledby":o.titleMounted?o.getTitleId():void 0,style:[r,h],className:Q({[ee.content]:!o.unstyled},t),unstyled:o.unstyled,children:i.children})})})})});Ve.displayName="@mantine/core/ModalBaseContent";const He=C.forwardRef(({className:s,...t},n)=>{const a=q();return e.jsx(H,{component:"header",ref:n,className:Q({[ee.header]:!a.unstyled},s),...t})});He.displayName="@mantine/core/ModalBaseHeader";const qs={duration:200,timingFunction:"ease",transition:"fade"};function Xs(s){const t=q();return{...qs,...t.transitionProps,...s}}const Ue=C.forwardRef(({onClick:s,transitionProps:t,style:n,visible:a,...r},i)=>{const c=q(),o=Xs(t);return e.jsx(Pe,{mounted:a!==void 0?a:c.opened,...o,transition:"fade",children:h=>e.jsx(hs,{ref:i,fixed:!0,style:[n,h],zIndex:c.zIndex,unstyled:c.unstyled,onClick:u=>{s==null||s(u),c.closeOnClickOutside&&c.onClose()},...r})})});Ue.displayName="@mantine/core/ModalBaseOverlay";function Ws(){const s=q();return C.useEffect(()=>(s.setTitleMounted(!0),()=>s.setTitleMounted(!1)),[]),s.getTitleId()}const Ge=C.forwardRef(({className:s,...t},n)=>{const a=Ws(),r=q();return e.jsx(H,{component:"h2",ref:n,className:Q({[ee.title]:!r.unstyled},s),...t,id:a})});Ge.displayName="@mantine/core/ModalBaseTitle";function Zs({children:s}){return e.jsx(e.Fragment,{children:s})}const[Ks,Ie]=oe("Accordion component was not found in the tree");function Me({style:s,size:t=16,...n}){return e.jsx("svg",{viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{...s,width:Z(t),height:Z(t),display:"block"},...n,children:e.jsx("path",{d:"M3.13523 6.15803C3.3241 5.95657 3.64052 5.94637 3.84197 6.13523L7.5 9.56464L11.158 6.13523C11.3595 5.94637 11.6759 5.95657 11.8648 6.15803C12.0536 6.35949 12.0434 6.67591 11.842 6.86477L7.84197 10.6148C7.64964 10.7951 7.35036 10.7951 7.15803 10.6148L3.15803 6.86477C2.95657 6.67591 2.94637 6.35949 3.13523 6.15803Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"})})}Me.displayName="@mantine/core/AccordionChevron";const[Ys,qe]=oe("Accordion.Item component was not found in the tree");var re={root:"m_9bdbb667",panel:"m_df78851f",content:"m_4ba554d4",itemTitle:"m_8fa820a0",control:"m_4ba585b8","control--default":"m_6939a5e9","control--contained":"m_4271d21b",label:"m_df3ffa0f",chevron:"m_3f35ae96",icon:"m_9bd771fe",item:"m_9bd7b098","item--default":"m_fe19b709","item--contained":"m_1f921b3b","item--filled":"m_2cdf939a","item--separated":"m_9f59b069"};const Js={},Re=F((s,t)=>{const{classNames:n,className:a,style:r,styles:i,vars:c,chevron:o,icon:h,onClick:u,onKeyDown:m,children:_,disabled:v,mod:l,...I}=k("AccordionControl",Js,s),{value:T}=qe(),f=Ie(),p=f.isItemActive(T),w=typeof f.order=="number",g=`h${f.order}`,j=e.jsxs(ms,{...I,...f.getStyles("control",{className:a,classNames:n,style:r,styles:i,variant:f.variant}),unstyled:f.unstyled,mod:["accordion-control",{active:p,"chevron-position":f.chevronPosition,disabled:v},l],ref:t,onClick:S=>{u==null||u(S),f.onChange(T)},type:"button",disabled:v,"aria-expanded":p,"aria-controls":f.getRegionId(T),id:f.getControlId(T),onKeyDown:xs({siblingSelector:"[data-accordion-control]",parentSelector:"[data-accordion]",activateOnFocus:!1,loop:f.loop,orientation:"vertical",onKeyDown:m}),children:[e.jsx(H,{component:"span",mod:{rotate:!f.disableChevronRotation&&p,position:f.chevronPosition},...f.getStyles("chevron",{classNames:n,styles:i}),children:o||f.chevron}),e.jsx("span",{...f.getStyles("label",{classNames:n,styles:i}),children:_}),h&&e.jsx(H,{component:"span",mod:{"chevron-position":f.chevronPosition},...f.getStyles("icon",{classNames:n,styles:i}),children:h})]});return w?e.jsx(g,{...f.getStyles("itemTitle",{classNames:n,styles:i}),children:j}):j});Re.displayName="@mantine/core/AccordionControl";Re.classes=re;const Qs={},Ne=F((s,t)=>{const{classNames:n,className:a,style:r,styles:i,vars:c,value:o,mod:h,...u}=k("AccordionItem",Qs,s),m=Ie();return e.jsx(Ys,{value:{value:o},children:e.jsx(H,{ref:t,mod:[{active:m.isItemActive(o)},h],...m.getStyles("item",{className:a,classNames:n,styles:i,style:r,variant:m.variant}),...u})})});Ne.displayName="@mantine/core/AccordionItem";Ne.classes=re;const et={},Ae=F((s,t)=>{const{classNames:n,className:a,style:r,styles:i,vars:c,children:o,...h}=k("AccordionPanel",et,s),{value:u}=qe(),m=Ie();return e.jsx(Ns,{ref:t,...m.getStyles("panel",{className:a,classNames:n,style:r,styles:i}),...h,in:m.isItemActive(u),transitionDuration:m.transitionDuration??200,role:"region",id:m.getRegionId(u),"aria-labelledby":m.getControlId(u),children:e.jsx("div",{...m.getStyles("content",{classNames:n,styles:i}),children:o})})});Ae.displayName="@mantine/core/AccordionPanel";Ae.classes=re;const st={multiple:!1,disableChevronRotation:!1,chevronPosition:"right",variant:"default",chevron:e.jsx(Me,{})},tt=he((s,{transitionDuration:t,chevronSize:n,radius:a})=>({root:{"--accordion-transition-duration":t===void 0?void 0:`${t}ms`,"--accordion-chevron-size":n===void 0?void 0:Z(n),"--accordion-radius":a===void 0?void 0:Oe(a)}}));function B(s){const t=k("Accordion",st,s),{classNames:n,className:a,style:r,styles:i,unstyled:c,vars:o,children:h,multiple:u,value:m,defaultValue:_,onChange:v,id:l,loop:I,transitionDuration:T,disableChevronRotation:f,chevronPosition:p,chevronSize:w,order:g,chevron:j,variant:S,radius:A,...R}=t,M=De(l),[N,L]=ps({value:m,defaultValue:_,finalValue:u?[]:null,onChange:v}),W=D=>Array.isArray(N)?N.includes(D):D===N,d=D=>{const ne=Array.isArray(N)?N.includes(D)?N.filter(ns=>ns!==D):[...N,D]:D===N?null:D;L(ne)},z=ue({name:"Accordion",classes:re,props:t,className:a,style:r,classNames:n,styles:i,unstyled:c,vars:o,varsResolver:tt});return e.jsx(Ks,{value:{isItemActive:W,onChange:d,getControlId:ze(`${M}-control`,"Accordion.Item component was rendered with invalid value or without value"),getRegionId:ze(`${M}-panel`,"Accordion.Item component was rendered with invalid value or without value"),transitionDuration:T,disableChevronRotation:f,chevronPosition:p,order:g,chevron:j,loop:I,getStyles:z,variant:S,unstyled:c},children:e.jsx(H,{...z("root"),id:M,...R,variant:S,"data-accordion":!0,children:h})})}const nt=s=>s;B.extend=nt;B.withProps=fs(B);B.classes=re;B.displayName="@mantine/core/Accordion";B.Item=Ne;B.Panel=Ae;B.Control=Re;B.Chevron=Me;const at={multiple:!1},Xe=C.forwardRef((s,t)=>{const{onChange:n,children:a,multiple:r,accept:i,name:c,form:o,resetRef:h,disabled:u,capture:m,inputProps:_,...v}=k("FileButton",at,s),l=C.useRef(null),I=()=>{var p;!u&&((p=l.current)==null||p.click())},T=p=>{n(r?Array.from(p.currentTarget.files):p.currentTarget.files[0]||null)};return gs(h,()=>{l.current&&(l.current.value="")}),e.jsxs(e.Fragment,{children:[a({onClick:I,...v}),e.jsx("input",{style:{display:"none"},type:"file",accept:i,multiple:r,onChange:T,ref:js(t,l),name:c,form:o,capture:m,..._})]})});Xe.displayName="@mantine/core/FileButton";const[ot,te]=oe("Modal component was not found in tree");var X={root:"m_9df02822",content:"m_54c44539",inner:"m_1f958f16",header:"m_d0e2b9cd"};const lt={},me=F((s,t)=>{const n=k("ModalBody",lt,s),{classNames:a,className:r,style:i,styles:c,vars:o,...h}=n,u=te();return e.jsx(Fe,{ref:t,...u.getStyles("body",{classNames:a,style:i,styles:c,className:r}),...h})});me.classes=X;me.displayName="@mantine/core/ModalBody";const rt={},xe=F((s,t)=>{const n=k("ModalCloseButton",rt,s),{classNames:a,className:r,style:i,styles:c,vars:o,...h}=n,u=te();return e.jsx(Le,{ref:t,...u.getStyles("close",{classNames:a,style:i,styles:c,className:r}),...h})});xe.classes=X;xe.displayName="@mantine/core/ModalCloseButton";const it={},pe=F((s,t)=>{const n=k("ModalContent",it,s),{classNames:a,className:r,style:i,styles:c,vars:o,children:h,__hidden:u,...m}=n,_=te(),v=_.scrollAreaComponent||Zs;return e.jsx(Ve,{..._.getStyles("content",{className:r,style:i,styles:c,classNames:a}),innerProps:_.getStyles("inner",{className:r,style:i,styles:c,classNames:a}),"data-full-screen":_.fullScreen||void 0,"data-modal-content":!0,"data-hidden":u||void 0,ref:t,...m,children:e.jsx(v,{style:{maxHeight:_.fullScreen?"100dvh":`calc(100dvh - (${Z(_.yOffset)} * 2))`},children:h})})});pe.classes=X;pe.displayName="@mantine/core/ModalContent";const dt={},fe=F((s,t)=>{const n=k("ModalHeader",dt,s),{classNames:a,className:r,style:i,styles:c,vars:o,...h}=n,u=te();return e.jsx(He,{ref:t,...u.getStyles("header",{classNames:a,style:i,styles:c,className:r}),...h})});fe.classes=X;fe.displayName="@mantine/core/ModalHeader";const ct={},ge=F((s,t)=>{const n=k("ModalOverlay",ct,s),{classNames:a,className:r,style:i,styles:c,vars:o,...h}=n,u=te();return e.jsx(Ue,{ref:t,...u.getStyles("overlay",{classNames:a,style:i,styles:c,className:r}),...h})});ge.classes=X;ge.displayName="@mantine/core/ModalOverlay";const ut={__staticSelector:"Modal",closeOnClickOutside:!0,withinPortal:!0,lockScroll:!0,trapFocus:!0,returnFocus:!0,closeOnEscape:!0,keepMounted:!1,zIndex:le("modal"),transitionProps:{duration:200,transition:"fade-down"},yOffset:"5dvh"},ht=he((s,{radius:t,size:n,yOffset:a,xOffset:r})=>({root:{"--modal-radius":t===void 0?void 0:Oe(t),"--modal-size":vs(n,"modal-size"),"--modal-y-offset":Z(a),"--modal-x-offset":Z(r)}})),je=F((s,t)=>{const n=k("ModalRoot",ut,s),{classNames:a,className:r,style:i,styles:c,unstyled:o,vars:h,yOffset:u,scrollAreaComponent:m,radius:_,fullScreen:v,centered:l,xOffset:I,__staticSelector:T,...f}=n,p=ue({name:T,classes:X,props:n,className:r,style:i,classNames:a,styles:c,unstyled:o,vars:h,varsResolver:ht});return e.jsx(ot,{value:{yOffset:u,scrollAreaComponent:m,getStyles:p,fullScreen:v},children:e.jsx($e,{ref:t,...p("root"),"data-full-screen":v||void 0,"data-centered":l||void 0,unstyled:o,...f})})});je.classes=X;je.displayName="@mantine/core/ModalRoot";const[mt,xt]=ys();function We({children:s}){const[t,n]=C.useState([]),[a,r]=C.useState(le("modal"));return e.jsx(mt,{value:{stack:t,addModal:(i,c)=>{n(o=>[...new Set([...o,i])]),r(o=>typeof c=="number"&&typeof o=="number"?Math.max(o,c):o)},removeModal:i=>n(c=>c.filter(o=>o!==i)),getZIndex:i=>`calc(${a} + ${t.indexOf(i)} + 1)`,currentId:t[t.length-1],maxZIndex:a},children:s})}We.displayName="@mantine/core/ModalStack";const pt={},ve=F((s,t)=>{const n=k("ModalTitle",pt,s),{classNames:a,className:r,style:i,styles:c,vars:o,...h}=n,u=te();return e.jsx(Ge,{ref:t,...u.getStyles("title",{classNames:a,style:i,styles:c,className:r}),...h})});ve.classes=X;ve.displayName="@mantine/core/ModalTitle";const ft={closeOnClickOutside:!0,withinPortal:!0,lockScroll:!0,trapFocus:!0,returnFocus:!0,closeOnEscape:!0,keepMounted:!1,zIndex:le("modal"),transitionProps:{duration:200,transition:"fade-down"},withOverlay:!0,withCloseButton:!0},U=F((s,t)=>{const{title:n,withOverlay:a,overlayProps:r,withCloseButton:i,closeButtonProps:c,children:o,radius:h,opened:u,stackId:m,zIndex:_,...v}=k("Modal",ft,s),l=xt(),I=!!n||i,T=l&&m?{closeOnEscape:l.currentId===m,trapFocus:l.currentId===m,zIndex:l.getZIndex(m)}:{},f=a===!1?!1:m&&l?l.currentId===m:u;return C.useEffect(()=>{l&&m&&(u?l.addModal(m,_||le("modal")):l.removeModal(m))},[u,m,_]),e.jsxs(je,{ref:t,radius:h,opened:u,zIndex:l&&m?l.getZIndex(m):_,...v,...T,children:[a&&e.jsx(ge,{visible:f,transitionProps:l&&m?{duration:0}:void 0,...r}),e.jsxs(pe,{radius:h,__hidden:l&&m&&u?m!==l.currentId:!1,children:[I&&e.jsxs(fe,{children:[n&&e.jsx(ve,{children:n}),i&&e.jsx(xe,{...c})]}),e.jsx(me,{children:o})]})]})});U.classes=X;U.displayName="@mantine/core/Modal";U.Root=je;U.Overlay=ge;U.Content=pe;U.Body=me;U.Header=fe;U.Title=ve;U.CloseButton=xe;U.Stack=We;const[gt,jt]=oe("Table component was not found in the tree");var ie={table:"m_b23fa0ef",th:"m_4e7aa4f3",tr:"m_4e7aa4fd",td:"m_4e7aa4ef",tbody:"m_b2404537",thead:"m_b242d975",caption:"m_9e5a3ac7",scrollContainer:"m_a100c15",scrollContainerInner:"m_62259741"};function vt(s,t){if(!t)return;const n={};return t.columnBorder&&s.withColumnBorders&&(n["data-with-column-border"]=!0),t.rowBorder&&s.withRowBorders&&(n["data-with-row-border"]=!0),t.striped&&s.striped&&(n["data-striped"]=s.striped),t.highlightOnHover&&s.highlightOnHover&&(n["data-hover"]=!0),t.captionSide&&s.captionSide&&(n["data-side"]=s.captionSide),t.stickyHeader&&s.stickyHeader&&(n["data-sticky"]=!0),n}function J(s,t){const n=`Table${s.charAt(0).toUpperCase()}${s.slice(1)}`,a=F((r,i)=>{const c=k(n,{},r),{classNames:o,className:h,style:u,styles:m,..._}=c,v=jt();return e.jsx(H,{component:s,ref:i,...vt(v,t),...v.getStyles(s,{className:h,classNames:o,style:u,styles:m,props:c}),..._})});return a.displayName=`@mantine/core/${n}`,a.classes=ie,a}const we=J("th",{columnBorder:!0}),Ze=J("td",{columnBorder:!0}),de=J("tr",{rowBorder:!0,striped:!0,highlightOnHover:!0}),Ke=J("thead",{stickyHeader:!0}),Ye=J("tbody"),Je=J("tfoot"),Qe=J("caption",{captionSide:!0});function Ee({data:s}){return e.jsxs(e.Fragment,{children:[s.caption&&e.jsx(Qe,{children:s.caption}),s.head&&e.jsx(Ke,{children:e.jsx(de,{children:s.head.map((t,n)=>e.jsx(we,{children:t},n))})}),s.body&&e.jsx(Ye,{children:s.body.map((t,n)=>e.jsx(de,{children:t.map((a,r)=>e.jsx(Ze,{children:a},r))},n))}),s.foot&&e.jsx(Je,{children:e.jsx(de,{children:s.foot.map((t,n)=>e.jsx(we,{children:t},n))})})]})}Ee.displayName="@mantine/core/TableDataRenderer";const yt={type:"scrollarea"},bt=he((s,{minWidth:t,type:n})=>({scrollContainer:{"--table-min-width":Z(t),"--table-overflow":n==="native"?"auto":void 0}})),Be=F((s,t)=>{const n=k("TableScrollContainer",yt,s),{classNames:a,className:r,style:i,styles:c,unstyled:o,vars:h,children:u,minWidth:m,type:_,...v}=n,l=ue({name:"TableScrollContainer",classes:ie,props:n,className:r,style:i,classNames:a,styles:c,unstyled:o,vars:h,varsResolver:bt,rootSelector:"scrollContainer"});return e.jsx(H,{component:_==="scrollarea"?bs:"div",..._==="scrollarea"?{offsetScrollbars:"x"}:{},ref:t,...l("scrollContainer"),...v,children:e.jsx("div",{...l("scrollContainerInner"),children:u})})});Be.classes=ie;Be.displayName="@mantine/core/TableScrollContainer";const _t={withRowBorders:!0,verticalSpacing:7},Ct=he((s,{layout:t,captionSide:n,horizontalSpacing:a,verticalSpacing:r,borderColor:i,stripedColor:c,highlightOnHoverColor:o,striped:h,highlightOnHover:u,stickyHeaderOffset:m,stickyHeader:_})=>({table:{"--table-layout":t,"--table-caption-side":n,"--table-horizontal-spacing":_e(a),"--table-vertical-spacing":_e(r),"--table-border-color":i?ye(i,s):void 0,"--table-striped-color":h&&c?ye(c,s):void 0,"--table-highlight-on-hover-color":u&&o?ye(o,s):void 0,"--table-sticky-header-offset":_?Z(m):void 0}})),x=F((s,t)=>{const n=k("Table",_t,s),{classNames:a,className:r,style:i,styles:c,unstyled:o,vars:h,horizontalSpacing:u,verticalSpacing:m,captionSide:_,stripedColor:v,highlightOnHoverColor:l,striped:I,highlightOnHover:T,withColumnBorders:f,withRowBorders:p,withTableBorder:w,borderColor:g,layout:j,variant:S,data:A,children:R,stickyHeader:M,stickyHeaderOffset:N,mod:L,tabularNums:W,...d}=n,z=ue({name:"Table",props:n,className:r,style:i,classes:ie,classNames:a,styles:c,unstyled:o,rootSelector:"table",vars:h,varsResolver:Ct});return e.jsx(gt,{value:{getStyles:z,stickyHeader:M,striped:I===!0?"odd":I||void 0,highlightOnHover:T,withColumnBorders:f,withRowBorders:p,captionSide:_||"bottom"},children:e.jsx(H,{component:"table",variant:S,ref:t,mod:[{"data-with-table-border":w,"data-tabular-nums":W},L],...z("table"),...d,children:R||!!A&&e.jsx(Ee,{data:A})})})});x.classes=ie;x.displayName="@mantine/core/Table";x.Td=Ze;x.Th=we;x.Tr=de;x.Thead=Ke;x.Tbody=Ye;x.Tfoot=Je;x.Caption=Qe;x.ScrollContainer=Be;x.DataRenderer=Ee;/**
 * @license @tabler/icons-react v3.29.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var St=se("outline","devices","IconDevices",[["path",{d:"M13 9a1 1 0 0 1 1 -1h6a1 1 0 0 1 1 1v10a1 1 0 0 1 -1 1h-6a1 1 0 0 1 -1 -1v-10z",key:"svg-0"}],["path",{d:"M18 8v-3a1 1 0 0 0 -1 -1h-13a1 1 0 0 0 -1 1v12a1 1 0 0 0 1 1h9",key:"svg-1"}],["path",{d:"M16 9h2",key:"svg-2"}]]);/**
 * @license @tabler/icons-react v3.29.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var es=se("outline","edit","IconEdit",[["path",{d:"M7 7h-1a2 2 0 0 0 -2 2v9a2 2 0 0 0 2 2h9a2 2 0 0 0 2 -2v-1",key:"svg-0"}],["path",{d:"M20.385 6.585a2.1 2.1 0 0 0 -2.97 -2.97l-8.415 8.385v3h3l8.385 -8.415z",key:"svg-1"}],["path",{d:"M16 5l3 3",key:"svg-2"}]]);/**
 * @license @tabler/icons-react v3.29.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Tt=se("outline","file-export","IconFileExport",[["path",{d:"M14 3v4a1 1 0 0 0 1 1h4",key:"svg-0"}],["path",{d:"M11.5 21h-4.5a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v5m-5 6h7m-3 -3l3 3l-3 3",key:"svg-1"}]]);/**
 * @license @tabler/icons-react v3.29.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var wt=se("outline","player-pause","IconPlayerPause",[["path",{d:"M6 5m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v12a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z",key:"svg-0"}],["path",{d:"M14 5m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v12a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z",key:"svg-1"}]]);/**
 * @license @tabler/icons-react v3.29.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var ss=se("outline","plus","IconPlus",[["path",{d:"M12 5l0 14",key:"svg-0"}],["path",{d:"M5 12l14 0",key:"svg-1"}]]);/**
 * @license @tabler/icons-react v3.29.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var ts=se("outline","trash","IconTrash",[["path",{d:"M4 7l16 0",key:"svg-0"}],["path",{d:"M10 11l0 6",key:"svg-1"}],["path",{d:"M14 11l0 6",key:"svg-2"}],["path",{d:"M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12",key:"svg-3"}],["path",{d:"M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3",key:"svg-4"}]]);const It=({config:s,onChange:t})=>{const n=a=>{t({...s,...a})};return e.jsx(G,{gap:"md",children:e.jsxs(y,{children:[e.jsx(y.Col,{span:6,children:e.jsx(Y,{label:"Baud Rate",value:String(s.baud_rate),onChange:a=>n({baud_rate:Number(a)}),data:As.map(a=>({value:String(a),label:String(a)})),required:!0})}),e.jsx(y.Col,{span:6,children:e.jsx(Y,{label:"Data Bits",value:String(s.data_bits),onChange:a=>n({data_bits:Number(a)}),data:Es.map(a=>({value:String(a.value),label:a.label})),required:!0})}),e.jsx(y.Col,{span:6,children:e.jsx(Y,{label:"Parity",value:s.parity,onChange:a=>n({parity:a}),data:Bs.map(a=>({value:a.value,label:a.label})),required:!0})}),e.jsx(y.Col,{span:6,children:e.jsx(Y,{label:"Stop Bits",value:String(s.stop_bits),onChange:a=>n({stop_bits:Number(a)}),data:zs.map(a=>({value:String(a.value),label:a.label})),required:!0})}),e.jsx(y.Col,{span:6,children:e.jsx(K,{label:"Timeout (ms)",value:s.timeout_ms,onChange:a=>n({timeout_ms:Number(a)}),min:100,max:5e3,step:100,required:!0})})]})})},Mt=({slaves:s,onEdit:t,onDelete:n,onAdd:a})=>{const r=_s(),i=Cs({uuid:"4880c12c-fdcb-4077-8920-a450d7f9b907"}),{characteristic:c}=i.useBluetoothCharacteristic({uuid:"fec26ec4-6d71-4442-9f81-55bc21d658d6"}),[o,h]=C.useState(null),[u,m]=C.useState({}),_=async(v,l)=>{var T,f;if(!r.isConnected){O.show({message:"Not connected to device. Please connect via Bluetooth first.",color:"red"});return}if(!c){O.show({message:"Bluetooth characteristic not available. Please reconnect.",color:"red"});return}const I=`${v.slave_id}-${l.reg_id}`;h(I);try{const w=await new Is(c).readRegisterLive(v.slave_id,l.address,l.length,l.function_code);if(w.status==="success"&&w.data){const g=w.data,j=g.raw_values||[],S=g.timestamp||new Date().toISOString();let A;const R=g.interpretations;if(j.length>=2&&R){let M;const N=((T=l.data_type)==null?void 0:T.toLowerCase())||"uint16",L=((f=l.endianness)==null?void 0:f.toLowerCase())||"big";if(N.includes("float"))switch(L){case"big":M=R.float32_big_endian_ABCD;break;case"little":M=R.float32_little_endian_DCBA;break;case"mid_big":M=R.float32_mid_big_BADC;break;case"mid_little":M=R.float32_mid_little_CDAB;break;default:M=R.float32_big_endian_ABCD}else(N.includes("int32")||N.includes("uint32"))&&(L==="big"||L==="mid_big"?M=N.includes("uint")?R.uint32_big_endian:R.int32_big_endian:M=N.includes("uint")?R.uint32_little_endian:R.int32_little_endian);M!==void 0&&!isNaN(M)&&isFinite(M)?A=`${(M*(l.scale_factor||1)+(l.offset||0)).toFixed(4)} ${l.unit||""}`.trim():A="Invalid float value"}else j.length>0?A=`${(j[0]*(l.scale_factor||1)+(l.offset||0)).toFixed(2)} ${l.unit||""}`.trim():A="No data";m({...u,[I]:{value:A,rawValues:j,rawHex:g.raw_hex,hexValues:g.hex_values,interpretations:R,timestamp:S}}),O.show({message:`Successfully read ${l.name}: ${A}`,color:"green"})}else throw new Error(w.message||"Failed to read register")}catch(p){O.show({message:`Failed to read register: ${p.message||p}`,color:"red"}),console.error("Read register error:",p)}finally{h(null)}};return e.jsxs(G,{gap:"md",children:[s.length===0&&e.jsx(b,{c:"dimmed",ta:"center",py:"xl",children:'No Modbus slaves configured. Click "Add Slave" to get started.'}),s.map(v=>e.jsxs(Ss,{withBorder:!0,padding:"md",children:[e.jsxs(E,{justify:"space-between",mb:"xs",children:[e.jsxs(E,{children:[e.jsxs(b,{fw:600,size:"lg",children:["Slave ID ",v.slave_id,": ",v.name]}),e.jsx(Se,{color:v.enabled?"green":"gray",children:v.enabled?"Enabled":"Disabled"})]}),e.jsxs(E,{gap:"xs",children:[e.jsx(ce,{variant:"light",color:"blue",onClick:()=>t(v),"aria-label":"Edit slave",children:e.jsx(es,{size:16})}),e.jsx(ce,{variant:"light",color:"red",onClick:()=>n(v.slave_id),"aria-label":"Delete slave",children:e.jsx(ts,{size:16})})]})]}),e.jsxs(b,{size:"sm",c:"dimmed",children:[e.jsx("strong",{children:"Type:"})," ",v.device_type]}),e.jsxs(b,{size:"sm",c:"dimmed",mb:"md",children:[e.jsx("strong",{children:"Registers:"})," ",v.registers.length," configured"]}),v.registers.length>0&&e.jsx(B,{variant:"separated",children:v.registers.map((l,I)=>{var w,g,j,S,A,R;const T=`${v.slave_id}-${l.reg_id}`,f=o===T,p=u[T];return e.jsxs(B.Item,{value:`reg-${v.slave_id}-${I}`,children:[e.jsx(B.Control,{children:e.jsxs(E,{justify:"space-between",wrap:"nowrap",children:[e.jsxs("div",{children:[e.jsx(b,{size:"sm",fw:500,children:l.name}),e.jsxs(b,{size:"xs",c:"dimmed",children:["Addr: ",l.address," | FC: ",l.function_code," | Type:"," ",l.data_type]})]}),e.jsx(Se,{size:"sm",color:l.enabled?"green":"gray",children:l.enabled?"ON":"OFF"})]})}),e.jsx(B.Panel,{children:e.jsxs(G,{gap:"xs",children:[e.jsxs(y,{children:[e.jsx(y.Col,{span:6,children:e.jsxs(b,{size:"xs",c:"dimmed",children:["Register ID: ",l.reg_id]})}),e.jsx(y.Col,{span:6,children:e.jsxs(b,{size:"xs",c:"dimmed",children:["Address: ",l.address]})}),e.jsx(y.Col,{span:6,children:e.jsxs(b,{size:"xs",c:"dimmed",children:["Length: ",l.length," registers"]})}),e.jsx(y.Col,{span:6,children:e.jsxs(b,{size:"xs",c:"dimmed",children:["Function Code: ",l.function_code]})}),e.jsx(y.Col,{span:6,children:e.jsxs(b,{size:"xs",c:"dimmed",children:["Data Type: ",l.data_type]})}),e.jsx(y.Col,{span:6,children:e.jsxs(b,{size:"xs",c:"dimmed",children:["Endianness: ",l.endianness]})}),e.jsx(y.Col,{span:6,children:e.jsxs(b,{size:"xs",c:"dimmed",children:["Scale: ",l.scale_factor||1]})}),e.jsx(y.Col,{span:6,children:e.jsxs(b,{size:"xs",c:"dimmed",children:["Offset: ",l.offset||0]})}),l.unit&&e.jsx(y.Col,{span:6,children:e.jsxs(b,{size:"xs",c:"dimmed",children:["Unit: ",l.unit]})})]}),e.jsxs(E,{justify:"space-between",mt:"xs",children:[e.jsx(Ts,{label:"Read live data from this register via RS485",children:e.jsx(V,{size:"xs",variant:"light",leftSection:f?e.jsx(ws,{size:14}):e.jsx(Os,{size:14}),onClick:()=>_(v,l),disabled:f||!r.isConnected,children:f?"Reading...":"Read Live"})}),p&&e.jsxs(b,{size:"sm",fw:500,c:"green",children:["âœ“ ",p.value]})]}),p&&e.jsx(ke,{withBorder:!0,p:"xs",mt:"sm",bg:"gray.0",children:e.jsxs(G,{gap:"xs",children:[e.jsx(b,{size:"xs",fw:600,c:"blue",children:"ðŸ” Debug Information"}),e.jsxs(E,{gap:"xs",children:[e.jsx(b,{size:"xs",c:"dimmed",children:"Raw Values (DEC):"}),e.jsx(P,{fz:"xs",children:((w=p.rawValues)==null?void 0:w.join(", "))||"N/A"})]}),p.rawHex&&e.jsxs(E,{gap:"xs",children:[e.jsx(b,{size:"xs",c:"dimmed",children:"Raw Values (HEX):"}),e.jsx(P,{fz:"xs",c:"blue",children:p.rawHex})]}),p.hexValues&&e.jsxs(E,{gap:"xs",children:[e.jsx(b,{size:"xs",c:"dimmed",children:"Registers:"}),p.hexValues.map((M,N)=>e.jsxs(P,{fz:"xs",children:["Reg",N,": 0x",M]},N))]}),((g=p.interpretations)==null?void 0:g.raw_bytes)&&e.jsxs(E,{gap:"xs",children:[e.jsx(b,{size:"xs",c:"dimmed",children:"Raw Bytes:"}),e.jsx(P,{fz:"xs",c:"orange",children:p.interpretations.raw_bytes})]}),p.interpretations&&e.jsxs(e.Fragment,{children:[e.jsx(Te,{my:"xs",label:"Float32 Interpretations",labelPosition:"left"}),e.jsxs(x,{withTableBorder:!0,children:[e.jsx(x.Thead,{children:e.jsxs(x.Tr,{children:[e.jsx(x.Th,{children:"Format"}),e.jsx(x.Th,{children:"Value"})]})}),e.jsxs(x.Tbody,{children:[e.jsxs(x.Tr,{children:[e.jsx(x.Td,{children:e.jsx(P,{fz:"xs",children:"Big Endian (ABCD)"})}),e.jsx(x.Td,{fw:500,children:((j=p.interpretations.float32_big_endian_ABCD)==null?void 0:j.toFixed(6))??"N/A"})]}),e.jsxs(x.Tr,{children:[e.jsx(x.Td,{children:e.jsx(P,{fz:"xs",children:"Little Endian (DCBA)"})}),e.jsx(x.Td,{fw:500,children:((S=p.interpretations.float32_little_endian_DCBA)==null?void 0:S.toFixed(6))??"N/A"})]}),e.jsxs(x.Tr,{children:[e.jsx(x.Td,{children:e.jsx(P,{fz:"xs",children:"Mid-Big (BADC)"})}),e.jsx(x.Td,{fw:500,children:((A=p.interpretations.float32_mid_big_BADC)==null?void 0:A.toFixed(6))??"N/A"})]}),e.jsxs(x.Tr,{children:[e.jsx(x.Td,{children:e.jsx(P,{fz:"xs",children:"Mid-Little (CDAB)"})}),e.jsx(x.Td,{fw:500,children:((R=p.interpretations.float32_mid_little_CDAB)==null?void 0:R.toFixed(6))??"N/A"})]})]})]}),e.jsx(Te,{my:"xs",label:"Integer Interpretations",labelPosition:"left"}),e.jsxs(x,{withTableBorder:!0,children:[e.jsx(x.Thead,{children:e.jsxs(x.Tr,{children:[e.jsx(x.Th,{children:"Format"}),e.jsx(x.Th,{children:"Value"})]})}),e.jsxs(x.Tbody,{children:[e.jsxs(x.Tr,{children:[e.jsx(x.Td,{children:e.jsx(P,{fz:"xs",children:"UInt32 BE"})}),e.jsx(x.Td,{children:p.interpretations.uint32_big_endian??"N/A"})]}),e.jsxs(x.Tr,{children:[e.jsx(x.Td,{children:e.jsx(P,{fz:"xs",children:"UInt32 LE"})}),e.jsx(x.Td,{children:p.interpretations.uint32_little_endian??"N/A"})]}),e.jsxs(x.Tr,{children:[e.jsx(x.Td,{children:e.jsx(P,{fz:"xs",children:"Int32 BE"})}),e.jsx(x.Td,{children:p.interpretations.int32_big_endian??"N/A"})]}),e.jsxs(x.Tr,{children:[e.jsx(x.Td,{children:e.jsx(P,{fz:"xs",children:"Int32 LE"})}),e.jsx(x.Td,{children:p.interpretations.int32_little_endian??"N/A"})]}),e.jsxs(x.Tr,{children:[e.jsx(x.Td,{children:e.jsx(P,{fz:"xs",children:"UInt16 Reg0"})}),e.jsx(x.Td,{children:p.interpretations.uint16_reg0??"N/A"})]}),e.jsxs(x.Tr,{children:[e.jsx(x.Td,{children:e.jsx(P,{fz:"xs",children:"UInt16 Reg1"})}),e.jsx(x.Td,{children:p.interpretations.uint16_reg1??"N/A"})]}),e.jsxs(x.Tr,{children:[e.jsx(x.Td,{children:e.jsx(P,{fz:"xs",children:"Int16 Reg0"})}),e.jsx(x.Td,{children:p.interpretations.int16_reg0??"N/A"})]}),e.jsxs(x.Tr,{children:[e.jsx(x.Td,{children:e.jsx(P,{fz:"xs",children:"Int16 Reg1"})}),e.jsx(x.Td,{children:p.interpretations.int16_reg1??"N/A"})]})]})]})]}),e.jsxs(b,{size:"xs",c:"dimmed",children:["Read at: ",new Date(p.timestamp).toLocaleString()]})]})})]})})]},I)})}),v.registers.length===0&&e.jsx(b,{size:"sm",c:"dimmed",ta:"center",py:"md",children:"No registers configured for this slave"})]},v.slave_id)),e.jsx(V,{leftSection:e.jsx(ss,{size:16}),onClick:a,fullWidth:!0,children:"Add Slave Device"})]})},Rt=({opened:s,onClose:t,onSave:n,slave:a,existingSlaveIds:r})=>{const i=!!a,[c,o]=C.useState(!1),[h,u]=C.useState(1),[m,_]=C.useState(""),[v,l]=C.useState(""),[I,T]=C.useState(!0),[f,p]=C.useState([]),[w,g]=C.useState(null),[j,S]=C.useState({});C.useEffect(()=>{a?(u(a.slave_id),_(a.name),l(a.device_type),T(a.enabled),p(a.registers||[])):(u(1),_(""),l(""),T(!0),p([])),g(null),S({})},[a,s]);const A=()=>{if(f.length>=$.MAX_REGISTERS_PER_SLAVE){O.show({message:`Maximum ${$.MAX_REGISTERS_PER_SLAVE} registers per slave allowed`,color:"orange"});return}g(-1),S({reg_id:"",name:"",enabled:!0,address:0,length:1,function_code:3,data_type:"uint16",endianness:"big",scale_factor:1,offset:0,unit:""})},R=d=>{g(d),S({...f[d]})},M=()=>{if(!j.reg_id||!j.name){O.show({message:"Register ID and Name are required",color:"red"});return}if(f.some((D,ne)=>D.reg_id===j.reg_id&&ne!==w)){O.show({message:"Register ID must be unique",color:"red"});return}const z=j;if(w===-1)p([...f,z]);else if(w!==null){const D=[...f];D[w]=z,p(D)}g(null),S({})},N=d=>{window.confirm(`Delete register "${f[d].name}"?`)&&p(f.filter((D,ne)=>ne!==d))},L=()=>{g(null),S({})},W=async()=>{if(!m.trim()){O.show({message:"Slave name is required",color:"red"});return}if(h<$.SLAVE_ID_MIN||h>$.SLAVE_ID_MAX){O.show({message:`Slave ID must be between ${$.SLAVE_ID_MIN} and ${$.SLAVE_ID_MAX}`,color:"red"});return}if((!i||a.slave_id!==h)&&r.includes(h)){O.show({message:`Slave ID ${h} is already in use`,color:"red"});return}if(!(f.length===0&&!window.confirm("No registers configured. Do you want to save anyway?"))){o(!0);try{const d={slave_id:h,name:m.trim(),device_type:v.trim(),enabled:I,registers:f};await n(d),O.show({message:`Slave ${i?"updated":"added"} successfully`,color:"green"}),t()}catch{}finally{o(!1)}}};return e.jsx(U,{opened:s,onClose:t,title:e.jsx(b,{size:"lg",fw:600,children:i?"Edit Modbus Slave":"Add Modbus Slave"}),size:"xl",closeOnClickOutside:!1,children:e.jsxs(G,{gap:"md",children:[e.jsxs(y,{children:[e.jsx(y.Col,{span:6,children:e.jsx(K,{label:"Slave ID",value:h,onChange:d=>u(Number(d)),min:$.SLAVE_ID_MIN,max:$.SLAVE_ID_MAX,required:!0,disabled:i,description:i?"Slave ID cannot be changed":"1-247"})}),e.jsx(y.Col,{span:6,children:e.jsx(ae,{label:"Slave Name",value:m,onChange:d=>_(d.currentTarget.value),required:!0,placeholder:"e.g., Energy Meter"})}),e.jsx(y.Col,{span:6,children:e.jsx(ae,{label:"Device Type",value:v,onChange:d=>l(d.currentTarget.value),placeholder:"e.g., energy_meter"})}),e.jsx(y.Col,{span:12,children:e.jsx(Ce,{label:"Enabled",checked:I,onChange:d=>T(d.currentTarget.checked),description:"Enable/disable polling for this slave"})})]}),e.jsx(Te,{label:"Registers Configuration",labelPosition:"center"}),e.jsxs(G,{gap:"xs",children:[e.jsxs(E,{justify:"space-between",children:[e.jsxs(b,{size:"sm",fw:500,children:["Configured Registers (",f.length,"/",$.MAX_REGISTERS_PER_SLAVE,")"]}),e.jsx(V,{leftSection:e.jsx(ss,{size:16}),onClick:A,size:"xs",disabled:w!==null||f.length>=$.MAX_REGISTERS_PER_SLAVE,children:"Add Register"})]}),w!==null&&e.jsxs(G,{gap:"xs",p:"md",style:{border:"1px solid var(--mantine-color-blue-4)",borderRadius:"var(--mantine-radius-md)",backgroundColor:"var(--mantine-color-blue-0)"},children:[e.jsx(b,{size:"sm",fw:600,c:"blue",children:w===-1?"New Register":"Edit Register"}),e.jsxs(y,{children:[e.jsx(y.Col,{span:6,children:e.jsx(ae,{label:"Register ID",value:j.reg_id||"",onChange:d=>S({...j,reg_id:d.currentTarget.value}),required:!0,placeholder:"e.g., voltage_l1"})}),e.jsx(y.Col,{span:6,children:e.jsx(ae,{label:"Name",value:j.name||"",onChange:d=>S({...j,name:d.currentTarget.value}),required:!0,placeholder:"e.g., Voltage L1"})}),e.jsx(y.Col,{span:4,children:e.jsx(K,{label:"Address",value:j.address||0,onChange:d=>S({...j,address:Number(d)}),min:$.REGISTER_ADDRESS_MIN,max:$.REGISTER_ADDRESS_MAX})}),e.jsx(y.Col,{span:4,children:e.jsx(K,{label:"Length",value:j.length||1,onChange:d=>S({...j,length:Number(d)}),min:$.REGISTER_LENGTH_MIN,max:$.REGISTER_LENGTH_MAX})}),e.jsx(y.Col,{span:4,children:e.jsx(Y,{label:"Function Code",value:String(j.function_code||3),onChange:d=>S({...j,function_code:Number(d)}),data:Ds.map(d=>({value:String(d.value),label:d.label}))})}),e.jsx(y.Col,{span:6,children:e.jsx(Y,{label:"Data Type",value:j.data_type||"uint16",onChange:d=>S({...j,data_type:d}),data:Ps.map(d=>({value:d.value,label:d.label}))})}),e.jsx(y.Col,{span:6,children:e.jsx(Y,{label:"Endianness",value:j.endianness||"big",onChange:d=>S({...j,endianness:d}),data:ks.map(d=>({value:d.value,label:d.label}))})}),e.jsx(y.Col,{span:4,children:e.jsx(K,{label:"Scale Factor",value:j.scale_factor||1,onChange:d=>S({...j,scale_factor:Number(d)}),step:.1,decimalScale:4})}),e.jsx(y.Col,{span:4,children:e.jsx(K,{label:"Offset",value:j.offset||0,onChange:d=>S({...j,offset:Number(d)}),step:.1,decimalScale:4})}),e.jsx(y.Col,{span:4,children:e.jsx(ae,{label:"Unit",value:j.unit||"",onChange:d=>S({...j,unit:d.currentTarget.value}),placeholder:"e.g., V, A, W"})}),e.jsx(y.Col,{span:12,children:e.jsx(Ce,{label:"Enabled",checked:j.enabled!==!1,onChange:d=>S({...j,enabled:d.currentTarget.checked})})})]}),e.jsxs(E,{justify:"flex-end",gap:"xs",children:[e.jsx(V,{variant:"light",onClick:L,size:"xs",children:"Cancel"}),e.jsxs(V,{onClick:M,size:"xs",children:[w===-1?"Add":"Update"," Register"]})]})]}),f.length>0&&e.jsx(B,{variant:"contained",children:f.map((d,z)=>e.jsxs(B.Item,{value:`reg-${z}`,children:[e.jsx(B.Control,{children:e.jsx(E,{justify:"space-between",wrap:"nowrap",children:e.jsxs("div",{children:[e.jsx(b,{size:"sm",fw:500,children:d.name}),e.jsxs(b,{size:"xs",c:"dimmed",children:["ID: ",d.reg_id," | Addr: ",d.address," | FC: ",d.function_code," |"," ",d.data_type]})]})})}),e.jsx(B.Panel,{children:e.jsxs(G,{gap:"xs",children:[e.jsxs(y,{children:[e.jsx(y.Col,{span:6,children:e.jsxs(b,{size:"xs",c:"dimmed",children:["Address: ",d.address]})}),e.jsx(y.Col,{span:6,children:e.jsxs(b,{size:"xs",c:"dimmed",children:["Length: ",d.length]})}),e.jsx(y.Col,{span:6,children:e.jsxs(b,{size:"xs",c:"dimmed",children:["Function Code: ",d.function_code]})}),e.jsx(y.Col,{span:6,children:e.jsxs(b,{size:"xs",c:"dimmed",children:["Data Type: ",d.data_type]})}),e.jsx(y.Col,{span:6,children:e.jsxs(b,{size:"xs",c:"dimmed",children:["Scale: ",d.scale_factor||1]})}),e.jsx(y.Col,{span:6,children:e.jsxs(b,{size:"xs",c:"dimmed",children:["Offset: ",d.offset||0]})}),e.jsx(y.Col,{span:6,children:e.jsxs(b,{size:"xs",c:"dimmed",children:["Unit: ",d.unit||"N/A"]})}),e.jsx(y.Col,{span:6,children:e.jsxs(b,{size:"xs",c:"dimmed",children:["Enabled: ",d.enabled?"Yes":"No"]})})]}),e.jsxs(E,{gap:"xs",children:[e.jsx(ce,{variant:"light",color:"blue",onClick:()=>R(z),disabled:w!==null,children:e.jsx(es,{size:16})}),e.jsx(ce,{variant:"light",color:"red",onClick:()=>N(z),disabled:w!==null,children:e.jsx(ts,{size:16})})]})]})})]},z))}),f.length===0&&w===null&&e.jsx(b,{size:"sm",c:"dimmed",ta:"center",py:"md",children:'No registers configured. Click "Add Register" to add one.'})]}),e.jsxs(E,{justify:"flex-end",mt:"md",children:[e.jsx(V,{variant:"light",onClick:t,disabled:c,children:"Cancel"}),e.jsxs(V,{onClick:W,loading:c,children:[i?"Update":"Add"," Slave"]})]})]})})},Pt=()=>{const s=$s(),[t,n]=C.useState(null),[a,r]=C.useState(!1),[i,c]=C.useState(null),[o,h]=C.useState(!1),[u,m]=C.useState(!1);C.useEffect(()=>{s.modbusConfig&&(n(s.modbusConfig),s.modbusConfig.read_paused!==void 0&&h(s.modbusConfig.read_paused))},[s.modbusConfig]);const _=async()=>{if(!t){O.show({message:"No configuration to save",color:"red"});return}try{await s.saveModbusConfig({uart_config:t.uart_config,retry_count:t.retry_count})}catch{}},v=async g=>{if(window.confirm(`Are you sure you want to delete Slave ID ${g}? This action cannot be undone.`))try{await s.deleteSlave(g)}catch{}},l=g=>{c(g),r(!0)},I=()=>{c(null),r(!0)},T=()=>{r(!1),c(null)},f=async g=>{m(!0);try{await s.pauseModbusRead(g),h(g),O.show({message:g?"Modbus reading paused":"Modbus reading resumed",color:g?"orange":"green"})}catch{}finally{m(!1)}},p=async g=>{if(g)try{const j=await g.text(),S=JSON.parse(j),A=S.modbus_config||S;if(!A.uart_config){O.show({message:"Invalid configuration file: missing uart_config",color:"red"});return}await s.importModbusConfig(A)}catch(j){O.show({message:`Failed to import: ${j instanceof Error?j.message:"Invalid JSON file"}`,color:"red"})}},w=async g=>{i?await s.updateSlave(g.slave_id,g):await s.addSlave(g),await s.loadModbusConfig()};return e.jsxs(G,{gap:"md",children:[e.jsxs(E,{justify:"space-between",children:[e.jsx(b,{size:"xl",fw:700,children:"Modbus Configuration"}),e.jsxs(E,{children:[e.jsx(V,{variant:"light",leftSection:e.jsx(Fs,{size:16}),onClick:()=>s.loadModbusConfig(),loading:s.isLoading,children:"Get Config"}),e.jsx(V,{variant:"light",color:"teal",leftSection:e.jsx(Tt,{size:16}),onClick:()=>s.exportModbusConfig(),disabled:!t,children:"Export"}),e.jsx(Xe,{onChange:p,accept:"application/json,.json",children:g=>e.jsx(V,{variant:"light",color:"orange",leftSection:e.jsx(Ls,{size:16}),loading:s.isLoading,...g,children:"Import"})})]})]}),!t&&!s.isLoading&&e.jsx(b,{c:"dimmed",ta:"center",py:"xl",children:'Click "Get Config" to load current Modbus configuration'}),t&&e.jsxs(e.Fragment,{children:[e.jsx(be,{title:"Modbus Polling Control",icon:o?e.jsx(wt,{size:20,color:"var(--mantine-color-orange-6)"}):e.jsx(Ms,{size:20,color:"var(--mantine-color-green-6)"}),children:e.jsxs(E,{align:"center",gap:"md",children:[e.jsx(Ce,{size:"lg",color:o?"orange":"green",checked:o,onChange:g=>f(g.currentTarget.checked),disabled:u,label:"Pause Modbus Read",description:"Temporarily stops data collection polling so BLE commands and live reads respond faster"}),e.jsx(Se,{color:o?"orange":"green",size:"lg",variant:"light",children:o?"Polling Paused":"Polling Active"})]})}),e.jsxs(be,{title:"UART Configuration",icon:e.jsx(Rs,{size:20}),children:[e.jsx(It,{config:t.uart_config,onChange:g=>n({...t,uart_config:g})}),e.jsx(y,{mt:"md",children:e.jsx(y.Col,{span:12,children:e.jsx(K,{label:"Retry Count",value:t.retry_count,onChange:g=>n({...t,retry_count:Number(g)}),min:1,max:10,description:"Number of retries on communication failure"})})}),e.jsx(E,{justify:"flex-end",mt:"md",children:e.jsx(V,{onClick:_,loading:s.isLoading,children:"Save UART Config"})})]}),e.jsx(be,{title:"Modbus Slave Devices",icon:e.jsx(St,{size:20}),children:e.jsx(Mt,{slaves:t.slaves||[],onEdit:l,onDelete:v,onAdd:I})})]}),e.jsx(Rt,{opened:a,onClose:T,onSave:w,slave:i,existingSlaveIds:((t==null?void 0:t.slaves)||[]).map(g=>g.slave_id)})]})};export{Pt as default};
