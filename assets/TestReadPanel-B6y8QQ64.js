import{P as se,w as f,Q as pe,e as je,R as ge,V as Me,j as e,W as ve,X as Te,B as $,Y as Se,Z as we,_ as D,$ as R,a0 as Be,a1 as te,a2 as be,a3 as Ie,a4 as Ne,f as I,u as N,r as q,a as ke,d as _e,n as ze,g as Ce,c as Re,s as L,S as Q,x as A,v as Ee,y as Pe,N as Oe,T as h}from"./index-PTjFC09f.js";import{B as Ae}from"./configOptions-DKBD50gn.js";import{u as $e}from"./useConfiguration-BA0L4BRG.js";import{N as De,C}from"./NumberInput-Yg5CGcNz.js";import{B as Y}from"./Badge-B309Sa-B.js";import{A as F,T as d}from"./Table-BDAThvQd.js";import{I as Fe}from"./ConfigCard-Bm8nn3Gy.js";const[He,w]=se("ModalBase component was not found in tree");function Le({opened:s,transitionDuration:t}){const[a,n]=f.useState(s),r=f.useRef(-1),i=pe()?0:t;return f.useEffect(()=>(s?(n(!0),window.clearTimeout(r.current)):i===0?n(!1):r.current=window.setTimeout(()=>n(!1),i),()=>window.clearTimeout(r.current)),[s,i]),a}function Ze({id:s,transitionProps:t,opened:a,trapFocus:n,closeOnEscape:r,onClose:c,returnFocus:i}){const o=je(s),[u,l]=f.useState(!1),[x,p]=f.useState(!1),g=typeof(t==null?void 0:t.duration)=="number"?t==null?void 0:t.duration:200,y=Le({opened:a,transitionDuration:g});return ge("keydown",M=>{var v;M.key==="Escape"&&r&&a&&((v=M.target)==null?void 0:v.getAttribute("data-mantine-stop-propagation"))!=="true"&&c()},{capture:!0}),Me({opened:a,shouldReturnFocus:n&&i}),{_id:o,titleMounted:u,bodyMounted:x,shouldLockScroll:y,setTitleMounted:l,setBodyMounted:p}}const ae=f.forwardRef(({keepMounted:s,opened:t,onClose:a,id:n,transitionProps:r,onExitTransitionEnd:c,onEnterTransitionEnd:i,trapFocus:o,closeOnEscape:u,returnFocus:l,closeOnClickOutside:x,withinPortal:p,portalProps:g,lockScroll:y,children:M,zIndex:v,shadow:b,padding:_,__vars:m,unstyled:T,removeScrollProps:j,...O},k)=>{const{_id:z,titleMounted:J,bodyMounted:ue,shouldLockScroll:xe,setTitleMounted:he,setBodyMounted:me}=Ze({id:n,transitionProps:r,opened:t,trapFocus:o,closeOnEscape:u,onClose:a,returnFocus:l}),{key:fe,...ye}=j||{};return e.jsx(ve,{...g,withinPortal:p,children:e.jsx(He,{value:{opened:t,onClose:a,closeOnClickOutside:x,onExitTransitionEnd:c,onEnterTransitionEnd:i,transitionProps:{...r,keepMounted:s},getTitleId:()=>`${z}-title`,getBodyId:()=>`${z}-body`,titleMounted:J,bodyMounted:ue,setTitleMounted:he,setBodyMounted:me,trapFocus:o,closeOnEscape:u,zIndex:v,unstyled:T},children:e.jsx(Te,{enabled:xe&&y,...ye,children:e.jsx($,{ref:k,...O,__vars:{...m,"--mb-z-index":(v||D("modal")).toString(),"--mb-shadow":we(b),"--mb-padding":Se(_)},children:M})},fe)})})});ae.displayName="@mantine/core/ModalBase";function Ke(){const s=w();return f.useEffect(()=>(s.setBodyMounted(!0),()=>s.setBodyMounted(!1)),[]),s.getBodyId()}var E={title:"m_615af6c9",header:"m_b5489c3c",inner:"m_60c222c7",content:"m_fd1ab0aa",close:"m_606cb269",body:"m_5df29311"};const ne=f.forwardRef(({className:s,...t},a)=>{const n=Ke(),r=w();return e.jsx($,{ref:a,...t,id:n,className:R({[E.body]:!r.unstyled},s)})});ne.displayName="@mantine/core/ModalBaseBody";const oe=f.forwardRef(({className:s,onClick:t,...a},n)=>{const r=w();return e.jsx(Be,{ref:n,...a,onClick:c=>{r.onClose(),t==null||t(c)},className:R({[E.close]:!r.unstyled},s),unstyled:r.unstyled})});oe.displayName="@mantine/core/ModalBaseCloseButton";const re=f.forwardRef(({transitionProps:s,className:t,innerProps:a,onKeyDown:n,style:r,...c},i)=>{const o=w();return e.jsx(te,{mounted:o.opened,transition:"pop",...o.transitionProps,onExited:()=>{var u,l,x;(u=o.onExitTransitionEnd)==null||u.call(o),(x=(l=o.transitionProps)==null?void 0:l.onExited)==null||x.call(l)},onEntered:()=>{var u,l,x;(u=o.onEnterTransitionEnd)==null||u.call(o),(x=(l=o.transitionProps)==null?void 0:l.onEntered)==null||x.call(l)},...s,children:u=>e.jsx("div",{...a,className:R({[E.inner]:!o.unstyled},a.className),children:e.jsx(be,{active:o.opened&&o.trapFocus,innerRef:i,children:e.jsx(Ie,{...c,component:"section",role:"dialog",tabIndex:-1,"aria-modal":!0,"aria-describedby":o.bodyMounted?o.getBodyId():void 0,"aria-labelledby":o.titleMounted?o.getTitleId():void 0,style:[r,u],className:R({[E.content]:!o.unstyled},t),unstyled:o.unstyled,children:c.children})})})})});re.displayName="@mantine/core/ModalBaseContent";const le=f.forwardRef(({className:s,...t},a)=>{const n=w();return e.jsx($,{component:"header",ref:a,className:R({[E.header]:!n.unstyled},s),...t})});le.displayName="@mantine/core/ModalBaseHeader";const Ue={duration:200,timingFunction:"ease",transition:"fade"};function Ve(s){const t=w();return{...Ue,...t.transitionProps,...s}}const de=f.forwardRef(({onClick:s,transitionProps:t,style:a,visible:n,...r},c)=>{const i=w(),o=Ve(t);return e.jsx(te,{mounted:n!==void 0?n:i.opened,...o,transition:"fade",children:u=>e.jsx(Ne,{ref:c,fixed:!0,style:[a,u],zIndex:i.zIndex,unstyled:i.unstyled,onClick:l=>{s==null||s(l),i.closeOnClickOutside&&i.onClose()},...r})})});de.displayName="@mantine/core/ModalBaseOverlay";function We(){const s=w();return f.useEffect(()=>(s.setTitleMounted(!0),()=>s.setTitleMounted(!1)),[]),s.getTitleId()}const ce=f.forwardRef(({className:s,...t},a)=>{const n=We(),r=w();return e.jsx($,{component:"h2",ref:a,className:R({[E.title]:!r.unstyled},s),...t,id:n})});ce.displayName="@mantine/core/ModalBaseTitle";function Xe({children:s}){return e.jsx(e.Fragment,{children:s})}const[Ge,P]=se("Modal component was not found in tree");var B={root:"m_9df02822",content:"m_54c44539",inner:"m_1f958f16",header:"m_d0e2b9cd"};const Je={},Z=I((s,t)=>{const a=N("ModalBody",Je,s),{classNames:n,className:r,style:c,styles:i,vars:o,...u}=a,l=P();return e.jsx(ne,{ref:t,...l.getStyles("body",{classNames:n,style:c,styles:i,className:r}),...u})});Z.classes=B;Z.displayName="@mantine/core/ModalBody";const Qe={},K=I((s,t)=>{const a=N("ModalCloseButton",Qe,s),{classNames:n,className:r,style:c,styles:i,vars:o,...u}=a,l=P();return e.jsx(oe,{ref:t,...l.getStyles("close",{classNames:n,style:c,styles:i,className:r}),...u})});K.classes=B;K.displayName="@mantine/core/ModalCloseButton";const Ye={},U=I((s,t)=>{const a=N("ModalContent",Ye,s),{classNames:n,className:r,style:c,styles:i,vars:o,children:u,__hidden:l,...x}=a,p=P(),g=p.scrollAreaComponent||Xe;return e.jsx(re,{...p.getStyles("content",{className:r,style:c,styles:i,classNames:n}),innerProps:p.getStyles("inner",{className:r,style:c,styles:i,classNames:n}),"data-full-screen":p.fullScreen||void 0,"data-modal-content":!0,"data-hidden":l||void 0,ref:t,...x,children:e.jsx(g,{style:{maxHeight:p.fullScreen?"100dvh":`calc(100dvh - (${q(p.yOffset)} * 2))`},children:u})})});U.classes=B;U.displayName="@mantine/core/ModalContent";const qe={},V=I((s,t)=>{const a=N("ModalHeader",qe,s),{classNames:n,className:r,style:c,styles:i,vars:o,...u}=a,l=P();return e.jsx(le,{ref:t,...l.getStyles("header",{classNames:n,style:c,styles:i,className:r}),...u})});V.classes=B;V.displayName="@mantine/core/ModalHeader";const es={},W=I((s,t)=>{const a=N("ModalOverlay",es,s),{classNames:n,className:r,style:c,styles:i,vars:o,...u}=a,l=P();return e.jsx(de,{ref:t,...l.getStyles("overlay",{classNames:n,style:c,styles:i,className:r}),...u})});W.classes=B;W.displayName="@mantine/core/ModalOverlay";const ss={__staticSelector:"Modal",closeOnClickOutside:!0,withinPortal:!0,lockScroll:!0,trapFocus:!0,returnFocus:!0,closeOnEscape:!0,keepMounted:!1,zIndex:D("modal"),transitionProps:{duration:200,transition:"fade-down"},yOffset:"5dvh"},ts=_e((s,{radius:t,size:a,yOffset:n,xOffset:r})=>({root:{"--modal-radius":t===void 0?void 0:Ce(t),"--modal-size":ze(a,"modal-size"),"--modal-y-offset":q(n),"--modal-x-offset":q(r)}})),X=I((s,t)=>{const a=N("ModalRoot",ss,s),{classNames:n,className:r,style:c,styles:i,unstyled:o,vars:u,yOffset:l,scrollAreaComponent:x,radius:p,fullScreen:g,centered:y,xOffset:M,__staticSelector:v,...b}=a,_=ke({name:v,classes:B,props:a,className:r,style:c,classNames:n,styles:i,unstyled:o,vars:u,varsResolver:ts});return e.jsx(Ge,{value:{yOffset:l,scrollAreaComponent:x,getStyles:_,fullScreen:g},children:e.jsx(ae,{ref:t,..._("root"),"data-full-screen":g||void 0,"data-centered":y||void 0,unstyled:o,...b})})});X.classes=B;X.displayName="@mantine/core/ModalRoot";const[as,ns]=Re();function ie({children:s}){const[t,a]=f.useState([]),[n,r]=f.useState(D("modal"));return e.jsx(as,{value:{stack:t,addModal:(c,i)=>{a(o=>[...new Set([...o,c])]),r(o=>typeof i=="number"&&typeof o=="number"?Math.max(o,i):o)},removeModal:c=>a(i=>i.filter(o=>o!==c)),getZIndex:c=>`calc(${n} + ${t.indexOf(c)} + 1)`,currentId:t[t.length-1],maxZIndex:n},children:s})}ie.displayName="@mantine/core/ModalStack";const os={},G=I((s,t)=>{const a=N("ModalTitle",os,s),{classNames:n,className:r,style:c,styles:i,vars:o,...u}=a,l=P();return e.jsx(ce,{ref:t,...l.getStyles("title",{classNames:n,style:c,styles:i,className:r}),...u})});G.classes=B;G.displayName="@mantine/core/ModalTitle";const rs={closeOnClickOutside:!0,withinPortal:!0,lockScroll:!0,trapFocus:!0,returnFocus:!0,closeOnEscape:!0,keepMounted:!1,zIndex:D("modal"),transitionProps:{duration:200,transition:"fade-down"},withOverlay:!0,withCloseButton:!0},S=I((s,t)=>{const{title:a,withOverlay:n,overlayProps:r,withCloseButton:c,closeButtonProps:i,children:o,radius:u,opened:l,stackId:x,zIndex:p,...g}=N("Modal",rs,s),y=ns(),M=!!a||c,v=y&&x?{closeOnEscape:y.currentId===x,trapFocus:y.currentId===x,zIndex:y.getZIndex(x)}:{},b=n===!1?!1:x&&y?y.currentId===x:l;return f.useEffect(()=>{y&&x&&(l?y.addModal(x,p||D("modal")):y.removeModal(x))},[l,x,p]),e.jsxs(X,{ref:t,radius:u,opened:l,zIndex:y&&x?y.getZIndex(x):p,...g,...v,children:[n&&e.jsx(W,{visible:b,transitionProps:y&&x?{duration:0}:void 0,...r}),e.jsxs(U,{radius:u,__hidden:y&&x&&l?x!==y.currentId:!1,children:[M&&e.jsxs(V,{children:[a&&e.jsx(G,{children:a}),c&&e.jsx(K,{...i})]}),e.jsx(Z,{children:o})]})]})});S.classes=B;S.displayName="@mantine/core/Modal";S.Root=X;S.Overlay=W;S.Content=U;S.Body=Z;S.Header=V;S.Title=G;S.CloseButton=K;S.Stack=ie;/**
 * @license @tabler/icons-react v3.29.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var ls=L("outline","chevron-right","IconChevronRight",[["path",{d:"M9 6l6 6l-6 6",key:"svg-0"}]]);/**
 * @license @tabler/icons-react v3.29.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var ys=L("outline","edit","IconEdit",[["path",{d:"M7 7h-1a2 2 0 0 0 -2 2v9a2 2 0 0 0 2 2h9a2 2 0 0 0 2 -2v-1",key:"svg-0"}],["path",{d:"M20.385 6.585a2.1 2.1 0 0 0 -2.97 -2.97l-8.415 8.385v3h3l8.385 -8.415z",key:"svg-1"}],["path",{d:"M16 5l3 3",key:"svg-2"}]]);/**
 * @license @tabler/icons-react v3.29.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var ps=L("outline","plus","IconPlus",[["path",{d:"M12 5l0 14",key:"svg-0"}],["path",{d:"M5 12l14 0",key:"svg-1"}]]);/**
 * @license @tabler/icons-react v3.29.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var js=L("outline","trash","IconTrash",[["path",{d:"M4 7l16 0",key:"svg-0"}],["path",{d:"M10 11l0 6",key:"svg-1"}],["path",{d:"M14 11l0 6",key:"svg-2"}],["path",{d:"M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12",key:"svg-3"}],["path",{d:"M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3",key:"svg-4"}]]);const H=[{key:"ABCD",label:"Big (ABCD)",desc:"No swap"},{key:"CDAB",label:"Mid-Little (CDAB)",desc:"Word swap"},{key:"BADC",label:"Mid-Big (BADC)",desc:"Byte swap"},{key:"DCBA",label:"Little (DCBA)",desc:"Both swap"}],ee=s=>s==null?"—":typeof s!="number"||!isFinite(s)||Number.isInteger(s)?String(s):s.toFixed(4),ds=({param:s})=>{const t=s.interpretations;return e.jsxs($,{bg:"gray.0",p:"sm",style:{borderTop:"1px solid var(--mantine-color-gray-3)"},children:[e.jsxs(A,{gap:"xs",mb:"xs",wrap:"wrap",children:[e.jsx(h,{size:"xs",fw:600,children:"Raw HEX:"}),e.jsx(C,{ff:"monospace",children:s.raw_hex||"—"}),e.jsx(h,{size:"xs",fw:600,ml:"xs",children:"Bytes (ABCD):"}),e.jsx(C,{ff:"monospace",children:s.raw_bytes||"—"}),e.jsx(h,{size:"xs",fw:600,ml:"xs",children:"Reg0:"}),e.jsx(C,{ff:"monospace",children:s.reg0??"—"}),e.jsx(h,{size:"xs",fw:600,ml:"xs",children:"Reg1:"}),e.jsx(C,{ff:"monospace",children:s.reg1??"—"})]}),t?e.jsxs(d,{withTableBorder:!0,striped:!0,highlightOnHover:!0,children:[e.jsx(d.Thead,{children:e.jsxs(d.Tr,{children:[e.jsx(d.Th,{style:{minWidth:80},children:"Type"}),H.map(a=>e.jsxs(d.Th,{children:[e.jsx(h,{size:"xs",fw:600,children:a.label}),e.jsx(h,{size:"xs",c:"dimmed",children:a.desc})]},a.key))]})}),e.jsxs(d.Tbody,{children:[e.jsxs(d.Tr,{children:[e.jsx(d.Td,{children:e.jsx(h,{size:"xs",fw:500,children:"UInt16"})}),e.jsx(d.Td,{colSpan:4,children:e.jsx(h,{size:"xs",ff:"monospace",children:t.uint16??"—"})})]}),e.jsxs(d.Tr,{children:[e.jsx(d.Td,{children:e.jsx(h,{size:"xs",fw:500,children:"Int16"})}),e.jsx(d.Td,{colSpan:4,children:e.jsx(h,{size:"xs",ff:"monospace",children:t.int16??"—"})})]}),e.jsxs(d.Tr,{children:[e.jsx(d.Td,{children:e.jsx(h,{size:"xs",fw:500,children:"Float32"})}),H.map(a=>{const n=`float32_${a.key}`,r=t[n];return e.jsx(d.Td,{children:e.jsx(h,{size:"xs",ff:"monospace",children:ee(r)})},a.key)})]}),e.jsxs(d.Tr,{children:[e.jsx(d.Td,{children:e.jsx(h,{size:"xs",fw:500,children:"UInt32"})}),H.map(a=>{const n=`uint32_${a.key}`;return e.jsx(d.Td,{children:e.jsx(h,{size:"xs",ff:"monospace",children:t[n]??"—"})},a.key)})]}),e.jsxs(d.Tr,{children:[e.jsx(d.Td,{children:e.jsx(h,{size:"xs",fw:500,children:"Int32"})}),H.map(a=>{const n=`int32_${a.key}`;return e.jsx(d.Td,{children:e.jsx(h,{size:"xs",ff:"monospace",children:t[n]??"—"})},a.key)})]})]})]}):e.jsx(h,{size:"xs",c:"dimmed",fs:"italic",children:"No interpretation data received. Please re-flash firmware with the latest version."})]})},gs=({profileId:s,defaultSlaveId:t})=>{const a=$e(),[n,r]=f.useState(t??1),[c,i]=f.useState(""),[o,u]=f.useState(!1),[l,x]=f.useState(null),[p,g]=f.useState(null),[y,M]=f.useState(new Set),v=m=>{M(T=>{const j=new Set(T);return j.has(m)?j.delete(m):j.add(m),j})},b=async()=>{u(!0),g(null),x(null),M(new Set);try{const m=c?Number(c):void 0,T=await a.testRead(n,s,m);console.log("TEST_READ response:",JSON.stringify(T,null,2)),x(T);const j=new Set;T.blocks.forEach((O,k)=>{O.parameters.forEach((z,J)=>{j.add(`${k}-${J}`)})}),M(j)}catch(m){g(m instanceof Error?m.message:"Test read failed")}finally{u(!1)}},_=[{value:"",label:"Current (no change)"},...Ae.map(m=>({value:String(m),label:String(m)}))];return e.jsxs(Q,{gap:"sm",children:[e.jsxs(A,{align:"flex-end",wrap:"wrap",children:[e.jsx(De,{label:"Slave ID",value:n,onChange:m=>r(Number(m)),min:1,max:247,w:100}),e.jsx(Ee,{label:"Baud Rate",data:_,value:c,onChange:m=>i(m||""),w:180}),e.jsx(Pe,{leftSection:e.jsx(Oe,{size:16}),onClick:b,loading:o,children:"Test Read"})]}),p&&e.jsx(h,{c:"red",size:"sm",children:p}),l&&e.jsxs(Q,{gap:"xs",children:[e.jsxs(A,{gap:"xs",children:[e.jsxs(Y,{color:"green",variant:"light",children:[l.successful," OK"]}),l.failed>0&&e.jsxs(Y,{color:"red",variant:"light",children:[l.failed," Failed"]}),e.jsxs(h,{size:"xs",c:"dimmed",children:["Total: ",l.total_parameters," parameters"]})]}),e.jsx(F,{variant:"separated",defaultValue:l.blocks.length===1?"block-0":void 0,children:l.blocks.map((m,T)=>e.jsxs(F.Item,{value:`block-${T}`,children:[e.jsx(F.Control,{children:e.jsxs(A,{gap:"xs",children:[e.jsx(h,{fw:500,size:"sm",children:m.block_name}),e.jsx(Y,{size:"xs",color:m.status==="ok"?"green":"red",variant:"light",children:m.status})]})}),e.jsx(F.Panel,{children:m.status==="ok"?e.jsxs(Q,{gap:"xs",children:[m.raw_hex&&e.jsxs(A,{gap:"xs",children:[e.jsx(h,{size:"xs",fw:600,children:"Block Raw HEX:"}),e.jsx(C,{style:{wordBreak:"break-all",fontSize:11},children:m.raw_hex})]}),e.jsxs(d,{withTableBorder:!0,striped:!0,children:[e.jsx(d.Thead,{children:e.jsxs(d.Tr,{children:[e.jsx(d.Th,{w:30}),e.jsx(d.Th,{children:"Parameter"}),e.jsx(d.Th,{children:"Addr"}),e.jsx(d.Th,{children:"HEX"}),e.jsx(d.Th,{children:"Decoded"}),e.jsx(d.Th,{children:"Scaled"}),e.jsx(d.Th,{children:"Unit"})]})}),e.jsx(d.Tbody,{children:m.parameters.map((j,O)=>{const k=`${T}-${O}`,z=y.has(k);return e.jsxs(f.Fragment,{children:[e.jsxs(d.Tr,{style:{cursor:"pointer"},onClick:()=>v(k),children:[e.jsx(d.Td,{children:z?e.jsx(Fe,{size:14}):e.jsx(ls,{size:14})}),e.jsx(d.Td,{children:e.jsx(h,{size:"sm",children:j.name})}),e.jsx(d.Td,{children:e.jsx(h,{size:"xs",ff:"monospace",c:"dimmed",children:j.absolute_address??"—"})}),e.jsx(d.Td,{children:e.jsx(C,{children:j.raw_hex||"—"})}),e.jsx(d.Td,{children:e.jsx(h,{size:"sm",ff:"monospace",children:ee(j.raw_value)})}),e.jsx(d.Td,{children:e.jsx(h,{size:"sm",ff:"monospace",fw:600,children:ee(j.scaled_value)})}),e.jsx(d.Td,{children:e.jsx(h,{size:"sm",c:"dimmed",children:j.unit})})]}),z&&e.jsx(d.Tr,{children:e.jsx(d.Td,{colSpan:7,style:{padding:0},children:e.jsx(ds,{param:j})})})]},k)})})]})]}):e.jsx(h,{size:"sm",c:"red",children:"Block read failed"})})]},T))})]})]})};export{ps as I,S as M,gs as T,ls as a,js as b,ys as c};
